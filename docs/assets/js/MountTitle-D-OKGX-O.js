import{_ as e,a,u as s}from"./index-DkhJWZ0D.js";import{c as t,p as l,s as n,B as i,m as o,t as u,F as c}from"./naive-ui-CtewNtT3.js";import{o as d,bn as r,bE as v,r as y,bf as _,bF as m,bg as p,aW as b,bh as k,bi as f,k as h,bj as g,F as w,bk as q,b7 as x,q as F}from"./vendor-CBGg7cPT.js";const C={class:"mount-emoji"},j={class:"mount-info"},z={class:"mount-name"},P={class:"mount-bonuses"},G={key:0},B={key:1},E={key:2},M={key:3},S={class:"mount-effect"},T={key:1,class:"empty-active"},U={class:"mount-grid"},I={class:"mount-card-name"},W={key:0,class:"lock-overlay"},A={class:"obtain-hint"},D={key:1,class:"owned-actions"},H={class:"title-desc"},J={class:"mount-bonuses"},K={key:0},L={key:1},N={key:2},O={key:1,class:"empty-active"},Q={class:"title-list"},R={class:"title-card-header"},V={class:"title-card-desc"},X={key:0,class:"title-card-bonus"},Y={key:0},Z={key:1},$={key:2},ee={key:1,class:"title-progress"},ae={class:"progress-label"},se={key:2,class:"title-card-actions"},te=e({__name:"MountTitle",setup(e){const{message:te}=t(["message"]),le=a(),ne=s(),ie=y("mount"),oe=y([]),ue=y([]),ce=y(null),de=y([]),re=y([]),ve=y(null),ye=y(!1),_e=y(!1),me={common:"å‡¡å“",rare:"çµå“",epic:"ä»™å“",legendary:"ç¥žå“",mythic:"ç¥žè¯"},pe={level:"ç„°é˜¶ç­‰çº§",kills:"å‡»æ€æ•°",dungeon_floor:"ç„šå¤©å¡”å±‚æ•°",spirit_stones:"ç„°æ™¶",friends:"ç„°å‹æ•°",contribution:"ç„°ç›Ÿè´¡çŒ®",boss_kill:"Bosså‡»æ€"},be=F(()=>{var e;return(null==(e=ce.value)?void 0:e.mount_id)||null}),ke=F(()=>{var e;return(null==(e=ve.value)?void 0:e.title_id)||null});function fe(e){return"ç™½é¹¤"===e.name||"èµ¤ç„°é©¬"===e.name}function he(e){return"èµ¤ç„°é©¬"===e.name?1e4:0}async function ge(){try{const[a,s]=await Promise.all([le.apiGet("/mount/list"),le.apiGet("/mount/active")]);oe.value=a.mounts,ce.value=s.mount,e=ce.value,ne.activeMountBonus=e?{attack_bonus:e.attack_bonus||0,defense_bonus:e.defense_bonus||0,health_bonus:e.health_bonus||0,speed_bonus:e.speed_bonus||0}:{attack_bonus:0,defense_bonus:0,health_bonus:0,speed_bonus:0};const t=await le.apiGet("/mount/my");ue.value=t.mounts}catch(a){te.error(a.message)}var e}async function we(){try{const[a,s]=await Promise.all([le.apiGet("/title/list"),le.apiGet("/title/my")]);de.value=a.titles,re.value=s.titles,ve.value=re.value.find(e=>e.is_active)||null,e=ve.value,ne.activeTitleBonus=e?{attack_bonus:e.attack_bonus||0,defense_bonus:e.defense_bonus||0,health_bonus:e.health_bonus||0,speed_bonus:e.speed_bonus||0}:{attack_bonus:0,defense_bonus:0,health_bonus:0,speed_bonus:0}}catch(a){te.error(a.message)}var e}async function qe(){try{await le.apiPost("/mount/deactivate",{}),te.success("å·²å¸ä¸‹ç„°éª‘"),await ge()}catch(e){te.error(e.message)}}async function xe(){_e.value=!0;try{const e=await le.apiPost("/title/check",{});e.count>0?(te.success("è§£é”äº† "+e.count+" ä¸ªæ–°ç„°å·ï¼"),e.newlyUnlocked.forEach(e=>te.info("ðŸŽ‰ èŽ·å¾—ç„°å·: "+e.name))):te.info("æš‚æ— æ–°ç„°å·å¯è§£é”"),await we()}catch(e){te.error(e.message)}_e.value=!1}async function Fe(){try{await le.apiPost("/title/deactivate",{}),te.success("å·²å¸ä¸‹ç„°å·"),await we()}catch(e){te.error(e.message)}}return d(()=>{ge(),we()}),(e,a)=>{const s=i,t=o,d=u,y=n,F=c,ne=l;return _(),r(ne,{type:"line",value:ie.value,"onUpdate:value":a[0]||(a[0]=e=>ie.value=e),animated:""},{default:v(()=>[m(y,{name:"mount",tab:"ðŸŽ ç„°éª‘"},{default:v(()=>[ce.value?(_(),p("div",{key:0,class:b(["active-mount-card","quality-"+ce.value.quality])},[k("div",C,f(ce.value.emoji),1),k("div",j,[k("div",z,[h(f(ce.value.name)+" ",1),k("span",{class:b(["quality-tag","qt-"+ce.value.quality])},f(me[ce.value.quality]),3)]),k("div",P,[ce.value.attack_bonus?(_(),p("span",G,"âš”ï¸æ”»å‡»+"+f((100*ce.value.attack_bonus).toFixed(0))+"%",1)):g("",!0),ce.value.defense_bonus?(_(),p("span",B,"ðŸ›¡ï¸é˜²å¾¡+"+f((100*ce.value.defense_bonus).toFixed(0))+"%",1)):g("",!0),ce.value.health_bonus?(_(),p("span",E,"â¤ï¸ç”Ÿå‘½+"+f((100*ce.value.health_bonus).toFixed(0))+"%",1)):g("",!0),ce.value.speed_bonus?(_(),p("span",M,"ðŸ’¨é€Ÿåº¦+"+f((100*ce.value.speed_bonus).toFixed(0))+"%",1)):g("",!0)]),k("div",S,"âœ¨ "+f(ce.value.special_effect),1)]),m(s,{type:"error",size:"small",onClick:qe},{default:v(()=>[...a[1]||(a[1]=[h("å¸ä¸‹",-1)])]),_:1})],2)):(_(),p("div",T,"ðŸ¾ å°šæœªè£…å¤‡ç„°éª‘")),m(t,null,{default:v(()=>[...a[2]||(a[2]=[h("ç„°éª‘å›¾é‰´",-1)])]),_:1}),k("div",U,[(_(!0),p(w,null,q(oe.value,e=>(_(),p("div",{key:e.id,class:b(["mount-card",[e.owned?"quality-"+e.quality:"locked",be.value===e.id?"card-active":""]])},[k("div",{class:b(["mount-card-emoji",{grayscale:!e.owned}])},f(e.emoji),3),k("div",I,f(e.name),1),k("span",{class:b(["quality-tag","qt-"+e.quality])},f(me[e.quality]),3),e.owned?(_(),p("div",D,[be.value!==e.id?(_(),r(s,{key:0,type:"primary",size:"tiny",onClick:a=>async function(e){try{const a=ue.value.find(a=>a.mount_id===e.id);if(!a)return te.error("æœªæ‹¥æœ‰è¯¥ç„°éª‘");await le.apiPost("/mount/activate",{player_mount_id:a.id}),te.success("éª‘ä¹˜æˆåŠŸ"),await ge()}catch(a){te.error(a.message)}}(e)},{default:v(()=>[...a[4]||(a[4]=[h("éª‘ä¹˜",-1)])]),_:1},8,["onClick"])):(_(),r(d,{key:1,type:"success",size:"small"},{default:v(()=>[...a[5]||(a[5]=[h("éª‘ä¹˜ä¸­",-1)])]),_:1}))])):(_(),p("div",W,[a[3]||(a[3]=k("span",{class:"lock-icon"},"ðŸ”’",-1)),k("div",A,f(e.obtain_method),1),fe(e)?(_(),r(s,{key:0,type:"warning",size:"tiny",onClick:a=>async function(e){ye.value=!0;try{const a=await le.apiPost("/mount/buy",{mount_id:e.id});te.success(a.message),await ge()}catch(a){te.error(a.message)}ye.value=!1}(e),loading:ye.value},{default:v(()=>[h(f("ç™½é¹¤"===e.name?"å…è´¹é¢†å–":"ðŸ’Ž "+he(e)+"ç„°æ™¶"),1)]),_:2},1032,["onClick","loading"])):g("",!0)]))],2))),128))])]),_:1}),m(y,{name:"title",tab:"ðŸ‘‘ ç„°å·"},{default:v(()=>[ve.value?(_(),p("div",{key:0,class:b(["active-title-card","quality-"+ve.value.quality])},[k("div",{class:"title-display",style:x({color:ve.value.color,textShadow:"0 0 10px "+ve.value.color+"88"})},f(ve.value.name),5),k("div",H,f(ve.value.description),1),k("div",J,[ve.value.attack_bonus?(_(),p("span",K,"âš”ï¸æ”»å‡»+"+f((100*ve.value.attack_bonus).toFixed(0))+"%",1)):g("",!0),ve.value.defense_bonus?(_(),p("span",L,"ðŸ›¡ï¸é˜²å¾¡+"+f((100*ve.value.defense_bonus).toFixed(0))+"%",1)):g("",!0),ve.value.health_bonus?(_(),p("span",N,"â¤ï¸ç”Ÿå‘½+"+f((100*ve.value.health_bonus).toFixed(0))+"%",1)):g("",!0)]),m(s,{type:"error",size:"small",onClick:Fe},{default:v(()=>[...a[6]||(a[6]=[h("å¸ä¸‹",-1)])]),_:1})],2)):(_(),p("div",O,"ðŸ‘‘ å°šæœªä½©æˆ´ç„°å·")),m(t,null,{default:v(()=>[m(s,{type:"info",size:"small",onClick:xe,loading:_e.value},{default:v(()=>[...a[7]||(a[7]=[h("ðŸ” æ£€æŸ¥æ–°ç„°å·",-1)])]),_:1},8,["loading"])]),_:1}),k("div",Q,[(_(!0),p(w,null,q(de.value,e=>(_(),p("div",{key:e.id,class:b(["title-card",[e.unlocked?"quality-"+e.quality:"locked",ke.value===e.id?"card-active":""]])},[k("div",R,[k("span",{class:"title-card-name",style:x(e.unlocked?{color:e.color,textShadow:"0 0 6px "+e.color+"66"}:{})},f(e.name),5),k("span",{class:b(["quality-tag","qt-"+e.quality])},f(me[e.quality]),3)]),k("div",V,f(e.description),1),e.attack_bonus||e.defense_bonus||e.health_bonus?(_(),p("div",X,[e.attack_bonus?(_(),p("span",Y,"âš”ï¸+"+f((100*e.attack_bonus).toFixed(0))+"%",1)):g("",!0),e.defense_bonus?(_(),p("span",Z,"ðŸ›¡ï¸+"+f((100*e.defense_bonus).toFixed(0))+"%",1)):g("",!0),e.health_bonus?(_(),p("span",$,"â¤ï¸+"+f((100*e.health_bonus).toFixed(0))+"%",1)):g("",!0)])):g("",!0),e.unlocked?(_(),p("div",se,[ke.value!==e.id?(_(),r(s,{key:0,type:"primary",size:"tiny",onClick:a=>async function(e){try{const a=re.value.find(a=>a.title_id===e.id);if(!a)return te.error("æœªè§£é”è¯¥ç„°å·");await le.apiPost("/title/activate",{player_title_id:a.id}),te.success("ä½©æˆ´æˆåŠŸ"),await we()}catch(a){te.error(a.message)}}(e)},{default:v(()=>[...a[8]||(a[8]=[h("ä½©æˆ´",-1)])]),_:1},8,["onClick"])):(_(),r(d,{key:1,type:"success",size:"small"},{default:v(()=>[...a[9]||(a[9]=[h("ä½©æˆ´ä¸­",-1)])]),_:1}))])):(_(),p("div",ee,[k("div",ae,f(pe[e.condition_type])+": "+f(e.current)+" / "+f(e.condition_value),1),m(F,{percentage:e.progress,"show-indicator":!1,height:8,color:e.progress>=100?"#4caf50":"#ffd700","rail-color":"rgba(255,255,255,0.1)"},null,8,["percentage","color"])]))],2))),128))])]),_:1})]),_:1},8,["value"])}}},[["__scopeId","data-v-e7acc4c3"]]);export{te as default};

import{_ as l,u as a,g as e,b as t}from"./index-C_Usn6qf.js";import{L as s}from"./LogPanel-C7MfT2ys.js";import{G as r}from"./GameGuide-Dc_uhL03.js";import{j as i,k as o,l as u,N as n,B as c,m as v,n as d,o as m}from"./naive-ui-CtewNtT3.js";import{o as p,aC as f,bn as g,bE as h,r as b,bf as y,bF as _,bh as k,k as C,b1 as M,bJ as x,bi as j,q as w}from"./vendor-CBGg7cPT.js";const B={class:"realm-display"},G=["src"],L={class:"realm-text"},z={class:"realm-name"},R=l({__name:"Cultivation",setup(l){const R=a(),$=b(null),U=w(()=>e(R.level)),A=w(()=>t(R.level)),W=b(1),q=()=>Math.floor(10*Math.pow(1.5,R.level-1)),D=w(()=>q()),E=w(()=>Math.floor(1*Math.pow(1.2,R.level-1))),F=()=>{const l=Math.max(0,R.maxCultivation-R.cultivation),a=(null==E?void 0:E.value)||1;if(a<=0)return 0;const e=Math.ceil(l/a);return Math.max(0,e*q())},I=w(()=>R.isAutoCultivating),J=(l,a)=>{var e;return null==(e=$.value)?void 0:e.addLog(l,a)},K=()=>R.cultivation>=R.maxCultivation,N=new Worker(new URL(""+new URL("../cultivation-B0OKljv2.js",import.meta.url).href,import.meta.url));N.onmessage=({data:l})=>{if("error"!==l.type){if("success"===l.type){const{spiritCost:a,cultivationGain:e,doubleGainTimes:t}=l.result;R.spirit-=a,R.cultivate(e),t>0&&J("success",`ç¦ç¼˜ä¸é”™ï¼Œè·å¾—${t}æ¬¡åŒå€ç„°åŠ›ï¼`),K()&&R.tryBreakthrough()?J("success",`çªç ´æˆåŠŸï¼æ­å–œè¿›å…¥${R.realm}ï¼`):K()?J("info","å·²è¾¾åˆ°çªç ´æ¡ä»¶ï¼Œä½†çªç ´å¤±è´¥ï¼Œè¯·ç»§ç»­åŠªåŠ›ï¼"):J("success","å†¥æƒ³æˆåŠŸï¼")}}else J("error",l.message)};const O=()=>{try{K()?R.tryBreakthrough()?J("success",`çªç ´æˆåŠŸï¼æ­å–œè¿›å…¥${R.realm}ï¼`):J("info","å·²è¾¾åˆ°çªç ´æ¡ä»¶ï¼Œä½†çªç ´å¤±è´¥ï¼Œè¯·ç»§ç»­åŠªåŠ›ï¼"):N.postMessage({type:"cultivateUntilBreakthrough",playerData:{level:R.level,spirit:R.spirit,cultivation:R.cultivation,maxCultivation:R.maxCultivation,luck:R.luck}})}catch(l){console.error("ç„°åŠ›çªç ´å‡ºé”™ï¼š",l),J("error","å†¥æƒ³å¤±è´¥ï¼")}},P=()=>{try{const l=q();if(R.spirit>=l){const a=R.realm;R.spirit-=l,R.cultivate((()=>{let l=E.value;return W.value>1&&(l=Math.floor(l*W.value)),Math.random()<.3*R.luck&&(l*=2,J("success","ç¦ç¼˜ä¸é”™ï¼Œè·å¾—åŒå€ç„°åŠ›ï¼")),l})()),R.realm!==a?J("success",`çªç ´æˆåŠŸï¼æ­å–œè¿›å…¥${R.realm}ï¼`):J("success","å†¥æƒ³æˆåŠŸï¼")}else J("error","ç„°çµä¸è¶³ï¼")}catch(l){console.error("ä¿®ç‚¼å‡ºé”™ï¼š",l),J("error","å†¥æƒ³å¤±è´¥ï¼")}},T=()=>{R.toggleAutoCultivation()};return p(()=>{(async()=>{var l;try{const a=await fetch("/api/events/effects"),e=await a.json();W.value=(null==(l=e.effects)?void 0:l.cultivationMultiplier)||1}catch{}})()}),f(()=>{try{N.terminate()}catch(l){console.error("æ¸…ç†Workerå‡ºé”™ï¼š",l)}}),(l,a)=>{const e=u,t=c,p=o,f=v,b=m,w=d,W=i;return y(),g(W,null,{default:h(()=>[_(p,{vertical:""},{default:h(()=>{var l;return[_(r,null,{default:h(()=>[...a[0]||(a[0]=[k("p",null,[C("ğŸ§˜ "),k("strong",null,"å†¥æƒ³"),C("æ¶ˆè€—ç„°çµè·å¾—ç„°åŠ›ï¼Œç„°åŠ›è¾¾åˆ°ä¸Šé™åå¯"),k("strong",null,"çªç ´ç„°é˜¶")],-1),k("p",null,"â¬†ï¸ çªç ´æå‡å¢ƒç•Œï¼Œè§£é”æ–°åœ°ç‚¹å’ŒåŠŸèƒ½ï¼Œå…±14å¤§å¢ƒç•Œ126çº§",-1),k("p",null,[C("âš¡ "),k("strong",null,"ç„°ä¿®é€Ÿç‡"),C("è¶Šé«˜ï¼Œæ¯æ¬¡å†¥æƒ³è·å¾—ç„°åŠ›è¶Šå¤š")],-1),k("p",null,[C("ğŸ² å¹¸è¿å€¼Ã—30%æ¦‚ç‡è·å¾—"),k("strong",null,"åŒå€ç„°åŠ›")],-1),k("p",null,[C("ğŸ¤– å¼€å¯"),k("strong",null,"è‡ªåŠ¨å†¥æƒ³"),C("å¯æŒ‚æœºï¼Œæ¯ç§’è‡ªåŠ¨å†¥æƒ³ä¸€æ¬¡")],-1),k("p",null,[C("ğŸ’¤ ç¦»çº¿æœ€å¤šç´¯ç§¯"),k("strong",null,"12å°æ—¶"),C("æ”¶ç›Šï¼ˆç„°åŠ›+ç„°æ™¶+ç„°çµï¼‰")],-1)])]),_:1}),_(e,{type:"info","show-icon":""},{icon:h(()=>[_(M(n),null,{default:h(()=>[_(M(x))]),_:1})]),default:h(()=>[a[1]||(a[1]=C(" é€šè¿‡ç„°å¿ƒå†¥æƒ³æ¥æå‡ç„°åŠ›ï¼Œç§¯ç´¯è¶³å¤Ÿçš„ç„°åŠ›åå¯ä»¥å°è¯•çªç ´ç„°é˜¶ã€‚ ",-1))]),_:1}),_(p,{vertical:""},{default:h(()=>[_(t,{type:"primary",size:"large",block:"",onClick:P,disabled:M(R).spirit<D.value},{default:h(()=>[C(" ç„°å¿ƒå†¥æƒ³ (æ¶ˆè€— "+j(D.value)+" ç„°çµ) ",1)]),_:1},8,["disabled"]),_(t,{type:I.value?"warning":"success",size:"large",block:"",onClick:T},{default:h(()=>[C(j(I.value?"åœæ­¢è‡ªåŠ¨å†¥æƒ³":"å¼€å§‹è‡ªåŠ¨å†¥æƒ³"),1)]),_:1},8,["type"]),_(t,{type:"info",size:"large",block:"",onClick:O,disabled:M(R).spirit<F()},{default:h(()=>[...a[2]||(a[2]=[C(" ç„°åŠ›çªç ´ ",-1)])]),_:1},8,["disabled"])]),_:1}),_(f,null,{default:h(()=>[...a[3]||(a[3]=[C("å†¥æƒ³è¯¦æƒ…",-1)])]),_:1}),k("div",B,[k("img",{src:U.value,class:"realm-icon",loading:"lazy"},null,8,G),k("div",L,[k("span",z,j(null==(l=A.value)?void 0:l.name),1)])]),_(w,{bordered:""},{default:h(()=>[_(b,{label:"ç„°çµè·å–é€Ÿç‡"},{default:h(()=>[C(j(1*M(R).spiritRate)+" / ç§’",1)]),_:1}),_(b,{label:"å†¥æƒ³æ•ˆç‡"},{default:h(()=>[C(j(E.value)+" ç„°åŠ› / æ¬¡",1)]),_:1}),_(b,{label:"çªç ´æ‰€éœ€ç„°åŠ›"},{default:h(()=>[C(j(M(R).maxCultivation),1)]),_:1})]),_:1}),_(s,{ref_key:"logRef",ref:$,title:"å†¥æƒ³æ—¥å¿—"},null,512)]}),_:1})]),_:1})}}},[["__scopeId","data-v-b641da02"]]);export{R as default};

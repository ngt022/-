import{_ as e,u as i,a as s}from"./index-C_Usn6qf.js";import{s as a}from"./sfx-Bhf_myqE.js";import{u as l,p as c,q as n,s as t,t as r,O as p,B as m}from"./naive-ui-CtewNtT3.js";import{o as u,bg as d,bh as g,bi as o,b1 as y,bF as v,bE as b,r as _,bf as f,F as h,bk as k,b7 as q,k as T,aW as w,bj as x,bn as S}from"./vendor-CBGg7cPT.js";const M={class:"shop-page"},C={class:"balance-bar"},V={class:"balance-value"},j={class:"equip-grid"},A=["onClick"],F=["src"],I={class:"equip-price"},z={class:"item-grid"},E=["onClick"],R=["src"],K={key:1,class:"item-icon"},U={class:"item-name"},B={class:"item-desc"},D={class:"item-price"},O={class:"item-grid"},L=["onClick"],H=["src"],N={key:1,class:"item-icon"},P={class:"item-name"},J={class:"item-desc"},W={class:"item-price"},G={class:"item-grid"},Q=["onClick"],X=["src"],Y={key:1,class:"item-icon"},Z={class:"item-name"},$={class:"item-desc"},ee={class:"item-price"},ie={class:"item-grid"},se=["onClick"],ae=["src"],le={key:1,class:"item-icon"},ce={class:"item-name"},ne={class:"item-desc"},te={class:"item-price"},re={class:"item-grid"},pe=["onClick"],me=["src"],ue={key:1,class:"item-icon"},de={class:"item-name"},ge={class:"item-desc"},oe={class:"item-price"},ye={class:"item-grid"},ve=["onClick"],be=["src"],_e={key:1,class:"item-icon"},fe={class:"item-desc"},he={class:"item-price"},ke={class:"item-grid formula-grid"},qe=["onClick"],Te=["src"],we={key:1,class:"item-icon"},xe={class:"item-name"},Se={class:"item-desc"},Me={class:"item-price"},Ce={key:2,class:"owned-badge"},Ve={class:"item-grid"},je=["onClick"],Ae=["src"],Fe={key:1,class:"item-icon"},Ie={class:"item-name"},ze={class:"item-desc"},Ee={class:"item-price"},Re={class:"pack-list"},Ke=["onClick"],Ue=["src"],Be={key:1,class:"pack-icon"},De={class:"pack-info"},Oe={class:"pack-name"},Le={class:"pack-desc"},He={class:"pack-price"},Ne={key:2,class:"pack-sold"},Pe={class:"item-grid buff-grid"},Je=["onClick"],We=["src"],Ge={key:1,class:"item-icon"},Qe={class:"item-name"},Xe={class:"item-desc"},Ye={class:"item-price"},Ze={key:2,class:"buff-active"},$e={key:0,class:"buy-content"},ei=["src"],ii={key:1,class:"buy-icon"},si={class:"buy-name"},ai={class:"buy-desc"},li={key:2,class:"buy-count"},ci={class:"buy-total"},ni={class:"total-price"},ti=e({__name:"Shop",setup(e){const ti=i(),ri=s(),pi=l(),mi=_("equip"),ui=_("rare"),di=_(!1),gi=_(null),oi=_(1),yi=_(!1),vi=_("è´­ä¹°ç¡®è®¤"),bi=_([]),_i=_({}),fi=e=>e?Number(e).toLocaleString():"0",hi=[{key:"rare",label:"ðŸ”µ ä¸­å“",color:"#2196f3",prefix:"ä¸­å“Â·",price:2e3},{key:"epic",label:"ðŸŸ£ ä¸Šå“",color:"#9c27b0",prefix:"ä¸Šå“Â·",price:8e3},{key:"legendary",label:"ðŸŸ  æžå“(å‘¨é™1)",color:"#ff9800",prefix:"æžå“Â·",price:3e4}],ki=[{key:"weapon",name:"æ­¦å™¨",img:"/assets/images/equip/weapon.png"},{key:"head",name:"å¤´éƒ¨",img:"/assets/images/equip/head.png"},{key:"body",name:"è¡£æœ",img:"/assets/images/equip/body.png"},{key:"legs",name:"è£¤å­",img:"/assets/images/equip/legs.png"},{key:"feet",name:"éž‹å­",img:"/assets/images/equip/feet.png"},{key:"shoulder",name:"è‚©ç”²",img:"/assets/images/equip/shoulder.png"},{key:"hands",name:"æ‰‹å¥—",img:"/assets/images/equip/hands.png"},{key:"wrist",name:"æŠ¤è…•",img:"/assets/images/equip/wrist.png"},{key:"necklace",name:"ç„°å¿ƒé“¾",img:"/assets/images/equip/necklace.png"},{key:"ring1",name:"ç¬¦æ–‡æˆ’1",img:"/assets/images/equip/ring.png"},{key:"ring2",name:"ç¬¦æ–‡æˆ’2",img:"/assets/images/equip/ring.png"},{key:"belt",name:"è…°å¸¦",img:"/assets/images/equip/belt.png"},{key:"artifact",name:"ç„°å™¨",img:"/assets/images/equip/artifact.png"}],qi=[{id:"spirit_small",name:"å°çµåŠ›è¯æ°´",img:"/assets/images/pills/pill_juling.png",desc:"+500çµåŠ›",price:500,canMulti:!0,buyType:"pill"},{id:"spirit_medium",name:"ä¸­çµåŠ›è¯æ°´",img:"/assets/images/pills/pill_juqi.png",desc:"+2,500çµåŠ›",price:2e3,canMulti:!0,buyType:"pill"},{id:"spirit_large",name:"å¤§çµåŠ›è¯æ°´",img:"/assets/images/pills/pill_xianling.png",desc:"+12,000çµåŠ›",price:8e3,canMulti:!0,buyType:"pill"}],Ti=[{id:"cult_small",name:"å°ä¿®ä¸ºä¸¹",img:"/assets/images/pills/pill_ningyuan.png",desc:"+ç­‰çº§Ã—100ä¿®ä¸º",price:1e3,canMulti:!0,buyType:"pill"},{id:"cult_medium",name:"ä¸­ä¿®ä¸ºä¸¹",img:"/assets/images/pills/pill_tianyuan.png",desc:"+ç­‰çº§Ã—600ä¿®ä¸º",price:5e3,canMulti:!0,buyType:"pill"},{id:"cult_large",name:"å¤§ä¿®ä¸ºä¸¹",img:"/assets/images/pills/pill_niepan.png",desc:"+ç­‰çº§Ã—3000ä¿®ä¸º",price:2e4,canMulti:!0,buyType:"pill"}],wi=[{id:"exp_1",name:"1çº§ç»éªŒä¸¹",img:"/assets/images/pills/pill_wuxing.png",desc:"ç›´æŽ¥å‡1çº§",price:5e4,canMulti:!0,buyType:"pill"},{id:"exp_5",name:"5çº§ç»éªŒä¸¹",img:"/assets/images/pills/pill_riyue.png",desc:"ç›´æŽ¥å‡5çº§",price:2e5,canMulti:!0,buyType:"pill"},{id:"exp_10",name:"10çº§ç»éªŒä¸¹",img:"/assets/images/pills/pill_niepan.png",desc:"ç›´æŽ¥å‡10çº§",price:5e5,canMulti:!0,buyType:"pill"}],xi=[{id:"attr_attack",name:"æ”»å‡»ä¸¹",img:"/assets/images/pills/pill_leiling.png",desc:"æ°¸ä¹…+50æ”»å‡»",price:3e3,canMulti:!0,buyType:"pill"},{id:"attr_health",name:"ç”Ÿå‘½ä¸¹",img:"/assets/images/pills/pill_huiling.png",desc:"æ°¸ä¹…+500ç”Ÿå‘½",price:3e3,canMulti:!0,buyType:"pill"},{id:"attr_defense",name:"é˜²å¾¡ä¸¹",img:"/assets/images/pills/pill_qingxin.png",desc:"æ°¸ä¹…+30é˜²å¾¡",price:3e3,canMulti:!0,buyType:"pill"},{id:"attr_speed",name:"é€Ÿåº¦ä¸¹",img:"/assets/images/pills/pill_huoyuan.png",desc:"æ°¸ä¹…+20é€Ÿåº¦",price:3e3,canMulti:!0,buyType:"pill"}],Si=[{id:"pill_frag_health",name:"å›žæ˜¥ç„°ä¸¹ç¢Žç‰‡",img:"/assets/images/pills/pill_huiling.png",desc:"æ”¶é›†5ä¸ªåˆæˆå›žæ˜¥ç„°æ–¹",price:1e3,canMulti:!0,buyType:"material"},{id:"pill_frag_attack",name:"ç ´å†›ç„°ä¸¹ç¢Žç‰‡",img:"/assets/images/pills/pill_leiling.png",desc:"æ”¶é›†5ä¸ªåˆæˆç ´å†›ç„°æ–¹",price:1500,canMulti:!0,buyType:"material"},{id:"pill_frag_defense",name:"é‡‘é’Ÿç„°ä¸¹ç¢Žç‰‡",img:"/assets/images/pills/pill_qingxin.png",desc:"æ”¶é›†5ä¸ªåˆæˆé‡‘é’Ÿç„°æ–¹",price:1500,canMulti:!0,buyType:"material"},{id:"pill_frag_speed",name:"ç–¾é£Žç„°ä¸¹ç¢Žç‰‡",img:"/assets/images/pills/pill_huoyuan.png",desc:"æ”¶é›†5ä¸ªåˆæˆç–¾é£Žç„°æ–¹",price:1200,canMulti:!0,buyType:"material"}],Mi=[{id:"spirit_grass",name:"çµç²¾è‰",baseValue:10,desc:"æœ€å¸¸è§çš„ç„°è‰ã€‚å¯ç‚¼åˆ¶ï¼šèšçµä¸¹",grade:1,img:"/assets/images/herbs/herb_spirit_grass.png"},{id:"cloud_flower",name:"äº‘é›¾èŠ±",baseValue:15,desc:"äº‘é›¾ä¸­çš„ç„°èŠ±ã€‚å¯ç‚¼åˆ¶ï¼šèšçµä¸¹ã€èšæ°”ä¸¹",grade:1,img:"/assets/images/herbs/herb_cloud_flower.png"},{id:"thunder_root",name:"é›·å‡»æ ¹",baseValue:25,desc:"é›·éœ†æ·¬ç‚¼çš„ç„°æ ¹ã€‚å¯ç‚¼åˆ¶ï¼šèšæ°”ä¸¹ã€é›·çµä¸¹",grade:2,img:"/assets/images/herbs/herb_thunder_root.png"},{id:"dark_yin_grass",name:"çŽ„é˜´è‰",baseValue:30,desc:"é˜´æš—å¤„çš„å¥‡è‰ã€‚å¯ç‚¼åˆ¶ï¼šå›žçµä¸¹",grade:2,img:"/assets/images/herbs/herb_dark_yin.png"},{id:"fire_heart_flower",name:"ç«å¿ƒèŠ±",baseValue:35,desc:"ç«å±±å£çš„å¥‡èŠ±ã€‚å¯ç‚¼åˆ¶ï¼šæ¸…å¿ƒä¸¹ã€ç«å…ƒä¸¹",grade:2,img:"/assets/images/herbs/herb_fire_heart.png"},{id:"dragon_breath_herb",name:"é¾™æ¯è‰",baseValue:40,desc:"é¾™æ°”å­•è‚²çš„ç„°è‰ã€‚å¯ç‚¼åˆ¶ï¼šé›·çµä¸¹ã€ä»™çµä¸¹ã€ç«å…ƒä¸¹",grade:3,img:"/assets/images/herbs/herb_dragon_breath.png"},{id:"nine_leaf_lingzhi",name:"ä¹å¶çµèŠ",baseValue:45,desc:"åƒå¹´çµèŠã€‚å¯ç‚¼åˆ¶ï¼šå‡å…ƒä¸¹",grade:3,img:"/assets/images/herbs/herb_nine_lingzhi.png"},{id:"purple_ginseng",name:"ç´«é‡‘å‚",baseValue:50,desc:"åƒå¹´ç´«å‚ã€‚å¯ç‚¼åˆ¶ï¼šå‡å…ƒä¸¹",grade:3,img:"/assets/images/herbs/herb_purple_ginseng.png"},{id:"frost_lotus",name:"å¯’éœœèŽ²",baseValue:55,desc:"æžå¯’ä¹‹èŽ²ã€‚å¯ç‚¼åˆ¶ï¼šå›žçµä¸¹ã€æ¸…å¿ƒä¸¹",grade:4,img:"/assets/images/herbs/herb_frost_lotus.png"},{id:"immortal_jade_grass",name:"ä»™çŽ‰è‰",baseValue:60,desc:"ä»™å¢ƒç„°è‰ã€‚å¯ç‚¼åˆ¶ï¼šä»™çµä¸¹",grade:4,img:"/assets/images/herbs/herb_immortal_jade.png"},{id:"moonlight_orchid",name:"æœˆåŽå…°",baseValue:70,desc:"æœˆåœ†ç»½æ”¾çš„å…°èŠ±ã€‚å¯ç‚¼åˆ¶ï¼šå¤©å…ƒä¸¹ã€æ—¥æœˆä¸¹",grade:5,img:"/assets/images/herbs/herb_moonlight_orchid.png"},{id:"sun_essence_flower",name:"æ—¥ç²¾èŠ±",baseValue:75,desc:"å¤ªé˜³ç²¾åŽä¹‹èŠ±ã€‚å¯ç‚¼åˆ¶ï¼šæ—¥æœˆä¸¹",grade:5,img:"/assets/images/herbs/herb_sun_essence.png"},{id:"five_elements_grass",name:"äº”è¡Œè‰",baseValue:80,desc:"äº”è¡Œåˆä¸€çš„å¥‡çã€‚å¯ç‚¼åˆ¶ï¼šäº”è¡Œä¸¹",grade:6,img:"/assets/images/herbs/herb_five_elements.png"},{id:"phoenix_feather_herb",name:"å‡¤ç¾½è‰",baseValue:85,desc:"å‡¤å‡°æ –æ¯åœ°çš„ç¥žè‰ã€‚å¯ç‚¼åˆ¶ï¼šäº”è¡Œä¸¹ã€æ¶…æ§ƒä¸¹",grade:6,img:"/assets/images/herbs/herb_phoenix_feather.png"},{id:"celestial_dew_grass",name:"å¤©éœ²è‰",baseValue:90,desc:"å¤©åœ°ç²¾åŽå‡èšã€‚å¯ç‚¼åˆ¶ï¼šå¤©å…ƒä¸¹ã€æ¶…æ§ƒä¸¹",grade:6,img:"/assets/images/herbs/herb_celestial_dew.png"}],Ci=[{key:"common",label:"æ™®é€š",mult:1,color:"#9e9e9e"},{key:"uncommon",label:"ä¼˜è´¨",mult:1.5,color:"#4caf50"},{key:"rare",label:"ç¨€æœ‰",mult:2,color:"#2196f3"},{key:"epic",label:"æžå“",mult:3,color:"#9c27b0"},{key:"legendary",label:"ä»™å“",mult:5,color:"#ff9800"}],Vi=_("common"),ji=[{id:"spirit_gathering",name:"èšçµä¸¹æ–¹",img:"/assets/images/pills/pill_juling.png",grade:"ä¸€å“",desc:"ç„°çµæ¢å¤+20%ï¼ŒæŒç»­60åˆ†é’Ÿã€‚éœ€è¦ï¼šçµç²¾è‰Ã—2ã€äº‘é›¾èŠ±Ã—1",price:5e3},{id:"cultivation_boost",name:"èšæ°”ä¸¹æ–¹",img:"/assets/images/pills/pill_juqi.png",grade:"äºŒå“",desc:"ç„°ä¿®é€Ÿåº¦+30%ï¼ŒæŒç»­30åˆ†é’Ÿã€‚éœ€è¦ï¼šäº‘é›¾èŠ±Ã—2ã€é›·å‡»æ ¹Ã—1",price:1e4},{id:"spirit_recovery",name:"å›žçµä¸¹æ–¹",img:"/assets/images/pills/pill_huiling.png",grade:"äºŒå“",desc:"ç„°çµæ¢å¤+40%ï¼ŒæŒç»­20åˆ†é’Ÿã€‚éœ€è¦ï¼šçŽ„é˜´è‰Ã—2ã€å¯’éœœèŽ²Ã—1",price:1e4},{id:"thunder_power",name:"é›·çµä¸¹æ–¹",img:"/assets/images/pills/pill_leiling.png",grade:"ä¸‰å“",desc:"æˆ˜æ–—å±žæ€§+40%ï¼ŒæŒç»­15åˆ†é’Ÿã€‚éœ€è¦ï¼šé›·å‡»æ ¹Ã—2ã€é¾™æ¯è‰Ã—1",price:2e4},{id:"essence_condensation",name:"å‡å…ƒä¸¹æ–¹",img:"/assets/images/pills/pill_ningyuan.png",grade:"ä¸‰å“",desc:"ç„°ä¿®æ•ˆçŽ‡+50%ï¼ŒæŒç»­25åˆ†é’Ÿã€‚éœ€è¦ï¼šä¹å¶çµèŠÃ—2ã€ç´«é‡‘å‚Ã—1",price:2e4},{id:"mind_clarity",name:"æ¸…å¿ƒä¸¹æ–¹",img:"/assets/images/pills/pill_qingxin.png",grade:"ä¸‰å“",desc:"æ‚Ÿæ€§+30%ï¼ŒæŒç»­40åˆ†é’Ÿã€‚éœ€è¦ï¼šå¯’éœœèŽ²Ã—2ã€ç«å¿ƒèŠ±Ã—1",price:2e4},{id:"immortal_essence",name:"ä»™çµä¸¹æ–¹",img:"/assets/images/pills/pill_xianling.png",grade:"å››å“",desc:"å…¨å±žæ€§+50%ï¼ŒæŒç»­10åˆ†é’Ÿã€‚éœ€è¦ï¼šé¾™æ¯è‰Ã—2ã€ä»™çŽ‰è‰Ã—1",price:4e4},{id:"fire_essence",name:"ç«å…ƒä¸¹æ–¹",img:"/assets/images/pills/pill_huoyuan.png",grade:"å››å“",desc:"ç«å±žæ€§ç„°ä¿®+60%ï¼ŒæŒç»­30åˆ†é’Ÿã€‚éœ€è¦ï¼šç«å¿ƒèŠ±Ã—2ã€é¾™æ¯è‰Ã—1",price:4e4},{id:"five_elements_pill",name:"äº”è¡Œä¸¹æ–¹",img:"/assets/images/pills/pill_wuxing.png",grade:"äº”å“",desc:"å…¨å±žæ€§+80%ï¼ŒæŒç»­20åˆ†é’Ÿã€‚éœ€è¦ï¼šäº”è¡Œè‰Ã—2ã€å‡¤ç¾½è‰Ã—1",price:8e4},{id:"celestial_essence_pill",name:"å¤©å…ƒä¸¹æ–¹",img:"/assets/images/pills/pill_tianyuan.png",grade:"å…­å“",desc:"ç„°ä¿®é€Ÿåº¦+100%ï¼ŒæŒç»­30åˆ†é’Ÿã€‚éœ€è¦ï¼šå¤©éœ²è‰Ã—2ã€æœˆåŽå…°Ã—1",price:15e4},{id:"sun_moon_pill",name:"æ—¥æœˆä¸¹æ–¹",img:"/assets/images/pills/pill_riyue.png",grade:"ä¸ƒå“",desc:"ç„°çµä¸Šé™+150%ï¼ŒæŒç»­40åˆ†é’Ÿã€‚éœ€è¦ï¼šæ—¥ç²¾èŠ±Ã—2ã€æœˆåŽå…°Ã—2",price:3e5},{id:"phoenix_rebirth_pill",name:"æ¶…æ§ƒä¸¹æ–¹",img:"/assets/images/pills/pill_niepan.png",grade:"å…«å“",desc:"è‡ªåŠ¨å›žè¡€10%ï¼ŒæŒç»­60åˆ†é’Ÿã€‚éœ€è¦ï¼šå‡¤ç¾½è‰Ã—3ã€å¤©éœ²è‰Ã—1",price:5e5}],Ai=[{id:"reinforce_1",name:"æ·¬ç«çŸ³ x1",img:"/assets/images/equip/weapon.png",desc:"è£…å¤‡æ·¬ç«å¿…å¤‡",price:1e3,canMulti:!0,buyType:"material"},{id:"reinforce_10",name:"æ·¬ç«çŸ³ x10",img:"/assets/images/equip/weapon.png",desc:"æ‰¹é‡è´­ä¹°9æŠ˜",price:9e3,canMulti:!0,buyType:"material",discount:"9æŠ˜"},{id:"refine_1",name:"ç¬¦æ–‡çŸ³ x1",img:"/assets/images/equip/artifact.png",desc:"é‡ç½®å‰¯å±žæ€§",price:1500,canMulti:!0,buyType:"material"},{id:"refine_10",name:"ç¬¦æ–‡çŸ³ x10",img:"/assets/images/equip/artifact.png",desc:"æ‰¹é‡è´­ä¹°9æŠ˜",price:13500,canMulti:!0,buyType:"material",discount:"9æŠ˜"},{id:"pet_essence",name:"ç„°å…½ç²¾åŽ",img:"/assets/images/menu/menu_gacha.png",desc:"+100ç²¾åŽ",price:2e3,canMulti:!0,buyType:"material"},{id:"pet_ticket",name:"å® ç‰©å¬å”¤åˆ¸",img:"/assets/images/menu/menu_gacha.png",desc:"ç­‰åŒä¸€æ¬¡å® ç‰©æŠ½å¡",price:5e3,canMulti:!0,buyType:"material"}],Fi=[{id:"pack_starter",name:"ðŸŒŸ æ–°æ‰‹ç¤¼åŒ…",img:"/assets/images/menu/menu_shop.png",desc:"ä¸­å“æ­¦å™¨+ä¸­å“è¡£æœ+æ·¬ç«çŸ³x10+ä¸­çµåŠ›è¯æ°´x5",price:1e4,buyType:"pack"},{id:"pack_advanced",name:"ðŸŒ™ è¿›é˜¶ç¤¼åŒ…",img:"/assets/images/menu/menu_shop.png",desc:"ä¸Šå“æ­¦å™¨+ä¸Šå“è¡£æœ+ç¬¦æ–‡çŸ³x20+ä¸­ä¿®ä¸ºä¸¹x5",price:5e4,buyType:"pack"},{id:"pack_supreme",name:"â˜€ï¸ è‡³å°Šç¤¼åŒ…",img:"/assets/images/menu/menu_shop.png",desc:"æžå“å…¨å¥—è£…å¤‡(13ä»¶)+æ·¬ç«çŸ³x50+ç¬¦æ–‡çŸ³x30",price:2e5,buyType:"pack"},{id:"pack_mythic",name:"ðŸ”¥ ä»™å“ç¤¼åŒ…",img:"/assets/images/menu/menu_shop.png",desc:"ä»™å“æ­¦å™¨+ä»™å“è¡£æœ+ä»™å“ç„°å™¨+5çº§ç»éªŒä¸¹x2",price:5e5,buyType:"pack"}],Ii=[{id:"double_crystal",name:"ç„°æ™¶åŒå€å¡",img:"/assets/images/icon-crystal.png",desc:"24å°æ—¶ç„°æ™¶èŽ·å–ç¿»å€",price:3e4,buyType:"buff",buffKey:"doubleCrystal"},{id:"cultivation_boost",name:"ä¿®ç‚¼åŠ é€Ÿå¡",img:"/assets/images/menu/menu_alchemy.png",desc:"24å°æ—¶ä¿®ç‚¼é€Ÿåº¦x3",price:2e4,buyType:"buff",buffKey:"cultivationBoost"},{id:"lucky_charm",name:"å¹¸è¿ç¬¦",img:"/assets/images/menu/menu_gacha.png",desc:"24å°æ—¶æŠ½å¡æ¦‚çŽ‡+50%",price:1e4,buyType:"buff",buffKey:"luckyCharm"}],zi=e=>{const i=_i.value[e];if(!i)return null;const s=i-Date.now();if(s<=0)return null;return Math.floor(s/36e5)+"æ—¶"+Math.floor(s%36e5/6e4)+"åˆ†"},Ei=async(e,i)=>{const s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+ri.token},body:JSON.stringify(i)}),a=await s.json();if(!s.ok)throw new Error(a.error||"è¯·æ±‚å¤±è´¥");return a},Ri=e=>{gi.value=e,oi.value=1,vi.value="è´­ä¹°ä¸¹è¯",di.value=!0},Ki=e=>{gi.value=e,oi.value=1,vi.value="è´­ä¹°ææ–™",di.value=!0},Ui=async()=>{if(!gi.value)return;const e=gi.value,i=e.price*oi.value;if(ti.spiritStones<i)return pi.error("ç„°æ™¶ä¸è¶³ï¼"),void a.error();if(ri.isLoggedIn){yi.value=!0;try{let i;if("equip"===e.buyType)i=await Ei("/api/shop/buy-equip",{quality:e.quality,equipType:e.equipType}),i.success&&(ti.spiritStones=i.spiritStones,ti.items.push(i.equip),pi.success("èŽ·å¾—è£…å¤‡ï¼š"+i.equip.name));else if("pill"===e.buyType){if(i=await Ei("/api/shop/buy-pill",{pillId:e.id,count:oi.value}),i.success){ti.spiritStones=i.spiritStones;const e=i.gameData;e&&(void 0!==e.spirit&&(ti.spirit=e.spirit),void 0!==e.cultivation&&(ti.cultivation=e.cultivation),void 0!==e.level&&(ti.level=e.level),void 0!==e.realm&&(ti.realm=e.realm),void 0!==e.maxCultivation&&(ti.maxCultivation=e.maxCultivation),e.baseAttributes&&(ti.baseAttributes=e.baseAttributes),void 0!==e.spiritRate&&(ti.spiritRate=e.spiritRate)),pi.success(i.message||"è´­ä¹°æˆåŠŸ")}}else if("material"===e.buyType){if(i=await Ei("/api/shop/buy-material",{itemId:e.id,count:oi.value}),i.success){ti.spiritStones=i.spiritStones;const e=i.items;if(e.reinforceStones&&(ti.reinforceStones+=e.reinforceStones),e.refinementStones&&(ti.refinementStones+=e.refinementStones),e.petEssence&&(ti.petEssence+=e.petEssence),e.pillFragments)for(const[i,s]of Object.entries(e.pillFragments))ti.pillFragments[i]||(ti.pillFragments[i]=0),ti.pillFragments[i]+=s;e.pets&&e.pets.length?(e.pets.forEach(e=>ti.items.push({...e,type:"pet"})),pi.success("èŽ·å¾—å® ç‰©ï¼š"+e.pets.map(e=>e.name).join(", "))):pi.success("è´­ä¹°æˆåŠŸ")}}else if("herb"===e.buyType)i=await Ei("/api/shop/buy-herb",{herbId:e.id,quality:e.quality,quantity:oi.value}),i.success&&(ti.spiritStones=i.spiritStones,pi.success(i.message||"è´­ä¹°æˆåŠŸ"),"function"==typeof ti.loadHerbsFromServer&&await ti.loadHerbsFromServer());else if("formula"===e.buyType)i=await Ei("/api/shop/buy-formula",{formulaId:e.id}),i.success&&(ti.spiritStones=i.spiritStones,ti.pillRecipes.push(e.id),pi.success(i.message||"ç„°æ–¹è§£é”æˆåŠŸ"));else if("pack"===e.buyType){if(i=await Ei("/api/shop/buy-pack",{packId:e.id}),i.success){ti.spiritStones=i.spiritStones,bi.value.push(e.id),i.equips&&i.equips.forEach(e=>ti.items.push(e));const s=i.gameData;s&&(void 0!==s.level&&(ti.level=s.level),void 0!==s.realm&&(ti.realm=s.realm),s.baseAttributes&&(ti.baseAttributes=s.baseAttributes),void 0!==s.reinforceStones&&(ti.reinforceStones=s.reinforceStones),void 0!==s.refinementStones&&(ti.refinementStones=s.refinementStones),void 0!==s.spirit&&(ti.spirit=s.spirit),void 0!==s.cultivation&&(ti.cultivation=s.cultivation)),pi.success("ç¤¼åŒ…å¼€å¯æˆåŠŸï¼")}}else"buff"===e.buyType&&(i=await Ei("/api/shop/buy-buff",{buffId:e.id}),i.success&&(ti.spiritStones=i.spiritStones,_i.value[i.buffKey]=i.expiresAt,pi.success("ç‰¹æƒæ¿€æ´»æˆåŠŸï¼")));a.purchase(),ti.saveData(),di.value=!1}catch(s){pi.error(s.message||"è´­ä¹°å¤±è´¥"),a.error()}finally{yi.value=!1}}else pi.warning("è¯·å…ˆç™»å½•")};return u(async()=>{if(ri.isLoggedIn)try{const e=await fetch("/api/shop/purchased-packs",{headers:{Authorization:"Bearer "+ri.token}}),i=await e.json();bi.value=i.purchasedPacks||[],_i.value=i.buffs||{}}catch(e){}}),(e,i)=>{const s=t,a=c,l=r,u=p,_=m,ri=n;return f(),d("div",M,[g("div",C,[i[5]||(i[5]=g("span",{class:"balance-icon"},"ðŸ’Ž",-1)),i[6]||(i[6]=g("span",{class:"balance-label"},"ç„°æ™¶ä½™é¢",-1)),g("span",V,o(fi(y(ti).spiritStones)),1)]),v(a,{type:"segment",value:mi.value,"onUpdate:value":i[2]||(i[2]=e=>mi.value=e),animated:"",class:"shop-tabs"},{default:b(()=>[v(s,{name:"equip",tab:"âš”ï¸ è£…å¤‡"},{default:b(()=>[v(a,{type:"line",value:ui.value,"onUpdate:value":i[0]||(i[0]=e=>ui.value=e),class:"quality-tabs"},{default:b(()=>[(f(),d(h,null,k(hi,e=>v(s,{key:e.key,name:e.key,tab:e.label},{default:b(()=>[g("div",j,[(f(),d(h,null,k(ki,i=>g("div",{key:i.key,class:"equip-card",style:q({borderColor:e.color+"80"}),onClick:s=>((e,i)=>{gi.value={name:e.prefix+i.name,img:i.img,desc:"ç­‰çº§=å½“å‰ç­‰çº§ å“è´¨="+e.label,price:e.price,canMulti:!1,buyType:"equip",quality:e.key,equipType:i.key},oi.value=1,vi.value="è´­ä¹°è£…å¤‡",di.value=!0})(e,i)},[g("div",{class:"card-glow",style:q({background:e.color+"15"})},null,4),g("img",{src:i.img,class:"equip-icon-img"},null,8,F),g("div",{class:"equip-name",style:q({color:e.color})},o(e.prefix)+o(i.name),5),g("div",I,"ðŸ’Ž "+o(fi(e.price)),1)],12,A)),64))])]),_:2},1032,["name","tab"])),64))]),_:1},8,["value"])]),_:1}),v(s,{name:"pill",tab:"ðŸ’Š ä¸¹è¯"},{default:b(()=>[i[7]||(i[7]=g("div",{class:"section-title"},"ðŸ”® çµåŠ›è¯æ°´",-1)),g("div",z,[(f(),d(h,null,k(qi,e=>g("div",{key:e.id,class:"item-card pill-card",onClick:i=>Ri(e)},[e.img?(f(),d("img",{key:0,src:e.img,class:"shop-item-img"},null,8,R)):(f(),d("div",K,o(e.icon),1)),g("div",U,o(e.name),1),g("div",B,o(e.desc),1),g("div",D,"ðŸ’Ž "+o(fi(e.price)),1)],8,E)),64))]),i[8]||(i[8]=g("div",{class:"section-title"},"ðŸ“¿ ä¿®ä¸ºä¸¹",-1)),g("div",O,[(f(),d(h,null,k(Ti,e=>g("div",{key:e.id,class:"item-card pill-card",onClick:i=>Ri(e)},[e.img?(f(),d("img",{key:0,src:e.img,class:"shop-item-img"},null,8,H)):(f(),d("div",N,o(e.icon),1)),g("div",P,o(e.name),1),g("div",J,o(e.desc),1),g("div",W,"ðŸ’Ž "+o(fi(e.price)),1)],8,L)),64))]),i[9]||(i[9]=g("div",{class:"section-title"},"â¬†ï¸ ç»éªŒä¸¹",-1)),g("div",G,[(f(),d(h,null,k(wi,e=>g("div",{key:e.id,class:"item-card pill-card exp-card",onClick:i=>Ri(e)},[e.img?(f(),d("img",{key:0,src:e.img,class:"shop-item-img"},null,8,X)):(f(),d("div",Y,o(e.icon),1)),g("div",Z,o(e.name),1),g("div",$,o(e.desc),1),g("div",ee,"ðŸ’Ž "+o(fi(e.price)),1)],8,Q)),64))]),i[10]||(i[10]=g("div",{class:"section-title"},"ðŸ’ª å±žæ€§ä¸¹ (æ°¸ä¹…)",-1)),g("div",ie,[(f(),d(h,null,k(xi,e=>g("div",{key:e.id,class:"item-card pill-card attr-card",onClick:i=>Ri(e)},[e.img?(f(),d("img",{key:0,src:e.img,class:"shop-item-img"},null,8,ae)):(f(),d("div",le,o(e.icon),1)),g("div",ce,o(e.name),1),g("div",ne,o(e.desc),1),g("div",te,"ðŸ’Ž "+o(fi(e.price)),1)],8,se)),64))]),i[11]||(i[11]=g("div",{class:"section-title"},"ðŸ§© ç„°æ–¹ç¢Žç‰‡",-1)),g("div",re,[(f(),d(h,null,k(Si,e=>g("div",{key:e.id,class:"item-card pill-card",onClick:i=>Ki(e)},[e.img?(f(),d("img",{key:0,src:e.img,class:"shop-item-img"},null,8,me)):(f(),d("div",ue,o(e.icon),1)),g("div",de,o(e.name),1),g("div",ge,o(e.desc),1),g("div",oe,"ðŸ’Ž "+o(fi(e.price)),1)],8,pe)),64))])]),_:1}),v(s,{name:"herb",tab:"ðŸŒ¿ ç„°è‰"},{default:b(()=>[v(a,{type:"line",value:Vi.value,"onUpdate:value":i[1]||(i[1]=e=>Vi.value=e),class:"quality-tabs"},{default:b(()=>[(f(),d(h,null,k(Ci,e=>v(s,{key:e.key,name:e.key,tab:e.label},{default:b(()=>[g("div",ye,[(f(),d(h,null,k(Mi,i=>g("div",{key:i.id,class:"item-card herb-card",onClick:e=>(e=>{var i;const s=(null==(i=Ci.find(e=>e.key===Vi.value))?void 0:i.mult)||1;gi.value={...e,price:Math.floor(e.baseValue*s*100),quality:Vi.value,canMulti:!0,buyType:"herb",icon:"ðŸŒ¿"},oi.value=1,vi.value="è´­ä¹°ç„°è‰",di.value=!0})(i)},[i.img?(f(),d("img",{key:0,src:i.img,class:"shop-item-img"},null,8,be)):(f(),d("div",_e,"ðŸŒ¿")),g("div",{class:"item-name",style:q({color:e.color})},o(i.name),5),g("div",fe,o(i.desc),1),g("div",he,"ðŸ’Ž "+o(fi(Math.floor(i.baseValue*e.mult*100))),1),v(l,{size:"tiny",style:q({background:e.color+"30",color:e.color,borderColor:e.color}),class:"tier-tag"},{default:b(()=>[T(o(i.grade)+"å“",1)]),_:2},1032,["style"])],8,ve)),64))])]),_:2},1032,["name","tab"])),64))]),_:1},8,["value"])]),_:1}),v(s,{name:"formula",tab:"ðŸ“œ ç„°æ–¹"},{default:b(()=>[g("div",ke,[(f(),d(h,null,k(ji,e=>g("div",{key:e.id,class:w(["item-card formula-card",{owned:y(ti).pillRecipes.includes(e.id)}]),onClick:i=>(e=>{ti.pillRecipes.includes(e.id)?pi.warning("å·²æ‹¥æœ‰è¯¥ç„°æ–¹"):(gi.value={...e,canMulti:!1,buyType:"formula",icon:"ðŸ“œ"},oi.value=1,vi.value="è´­ä¹°ç„°æ–¹",di.value=!0)})(e)},[e.img?(f(),d("img",{key:0,src:e.img,class:"shop-item-img"},null,8,Te)):(f(),d("div",we,"ðŸ“œ")),g("div",xe,o(e.name),1),v(l,{size:"tiny",type:"info",class:"grade-tag"},{default:b(()=>[T(o(e.grade),1)]),_:2},1024),g("div",Se,o(e.desc),1),g("div",Me,"ðŸ’Ž "+o(fi(e.price)),1),y(ti).pillRecipes.includes(e.id)?(f(),d("div",Ce,"å·²æ‹¥æœ‰")):x("",!0)],10,qe)),64))])]),_:1}),v(s,{name:"material",tab:"ðŸ”§ ææ–™"},{default:b(()=>[g("div",Ve,[(f(),d(h,null,k(Ai,e=>g("div",{key:e.id,class:"item-card material-card",onClick:i=>Ki(e)},[e.img?(f(),d("img",{key:0,src:e.img,class:"shop-item-img"},null,8,Ae)):(f(),d("div",Fe,o(e.icon),1)),g("div",Ie,o(e.name),1),g("div",ze,o(e.desc),1),g("div",Ee,"ðŸ’Ž "+o(fi(e.price)),1),e.discount?(f(),S(l,{key:2,type:"error",size:"tiny",class:"discount-tag"},{default:b(()=>[T(o(e.discount),1)]),_:2},1024)):x("",!0)],8,je)),64))])]),_:1}),v(s,{name:"pack",tab:"ðŸŽ ç¤¼åŒ…"},{default:b(()=>[g("div",Re,[(f(),d(h,null,k(Fi,e=>g("div",{key:e.id,class:w(["pack-card",{purchased:bi.value.includes(e.id)}]),onClick:i=>(e=>{bi.value.includes(e.id)?pi.warning("è¯¥ç¤¼åŒ…å·²è´­ä¹°è¿‡"):(gi.value={...e,canMulti:!1},oi.value=1,vi.value="è´­ä¹°ç¤¼åŒ…",di.value=!0)})(e)},[i[12]||(i[12]=g("div",{class:"pack-badge"},"è¶…å€¼",-1)),e.img?(f(),d("img",{key:0,src:e.img,class:"shop-pack-img"},null,8,Ue)):(f(),d("div",Be,o(e.icon),1)),g("div",De,[g("div",Oe,o(e.name),1),g("div",Le,o(e.desc),1),g("div",He,"ðŸ’Ž "+o(fi(e.price)),1)]),bi.value.includes(e.id)?(f(),d("div",Ne,"å·²è´­ä¹°")):x("",!0)],10,Ke)),64))])]),_:1}),v(s,{name:"buff",tab:"ðŸ’Ž ç‰¹æƒ"},{default:b(()=>[g("div",Pe,[(f(),d(h,null,k(Ii,e=>g("div",{key:e.id,class:"item-card buff-card",onClick:i=>(e=>{gi.value={...e,canMulti:!1},oi.value=1,vi.value="è´­ä¹°ç‰¹æƒ",di.value=!0})(e)},[e.img?(f(),d("img",{key:0,src:e.img,class:"shop-item-img"},null,8,We)):(f(),d("div",Ge,o(e.icon),1)),g("div",Qe,o(e.name),1),g("div",Xe,o(e.desc),1),g("div",Ye,"ðŸ’Ž "+o(fi(e.price)),1),zi(e.buffKey)?(f(),d("div",Ze," â³ å‰©ä½™ "+o(zi(e.buffKey)),1)):x("",!0)],8,Je)),64))])]),_:1})]),_:1},8,["value"]),v(ri,{show:di.value,"onUpdate:show":i[4]||(i[4]=e=>di.value=e),preset:"card",title:vi.value,style:{width:"340px","max-width":"90vw"},bordered:!1,class:"buy-modal"},{default:b(()=>[gi.value?(f(),d("div",$e,[gi.value.img?(f(),d("img",{key:0,src:gi.value.img,class:"buy-icon-img"},null,8,ei)):(f(),d("div",ii,o(gi.value.icon||"ðŸ“¦"),1)),g("div",si,o(gi.value.name),1),g("div",ai,o(gi.value.desc||""),1),gi.value.canMulti?(f(),d("div",li,[i[13]||(i[13]=g("span",null,"æ•°é‡",-1)),v(u,{value:oi.value,"onUpdate:value":i[3]||(i[3]=e=>oi.value=e),min:1,max:99,size:"small",style:{width:"100px"}},null,8,["value"])])):x("",!0),g("div",ci,[i[14]||(i[14]=T(" æ€»ä»·ï¼š",-1)),g("span",ni,"ðŸ’Ž "+o(fi(gi.value.price*oi.value)),1)]),v(_,{type:"warning",block:"",strong:"",loading:yi.value,onClick:Ui,disabled:y(ti).spiritStones<gi.value.price*oi.value},{default:b(()=>[T(o(y(ti).spiritStones<gi.value.price*oi.value?"ç„°æ™¶ä¸è¶³":"ç¡®è®¤è´­ä¹°"),1)]),_:1},8,["loading","disabled"])])):x("",!0)]),_:1},8,["show","title"])])}}},[["__scopeId","data-v-f1ae1a1d"]]);export{ti as default};

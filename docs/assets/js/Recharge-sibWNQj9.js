import{_ as e,a,u as t}from"./index-C_Usn6qf.js";import{u as s,k as o,l as n,j as l,H as r,D as i,E as u,O as c,B as d,Y as g}from"./naive-ui-CtewNtT3.js";import{o as v,bn as f,bE as _,r as p,bf as y,b1 as b,k as m,bj as k,bF as S,bg as h,F as L,bk as O,aW as w,bi as R,be as N,bP as x}from"./vendor-CBGg7cPT.js";const I=e({__name:"Recharge",setup(e){const I=a(),j=t(),z=s(),C=p(!1),F=p(null),D=p(null),P=p([]),$=[{roon:1,stones:1e4},{roon:5,stones:5e4},{roon:10,stones:1e5},{roon:50,stones:5e5},{roon:100,stones:1e6},{roon:500,stones:5e6}],B=[{title:"é‡‘é¢(ROON)",key:"amount",render:e=>Number(e.amount).toFixed(2)},{title:"ç„°æ™¶",key:"spirit_stones",render:e=>Number(e.spirit_stones).toLocaleString()},{title:"èµ é€",key:"bonus_stones",render:e=>Number(e.bonus_stones).toLocaleString()},{title:"æ—¶é—´",key:"created_at",render:e=>new Date(e.created_at).toLocaleString()}],E=async()=>{var e;const a=(null==(e=D.value)?void 0:e.roon)||F.value;if(!a||a<=0)return z.warning("è¯·é€‰æ‹©å……å€¼é‡‘é¢");C.value=!0;try{const e=new N(window.ethereum),t=await e.getSigner(),s=await t.sendTransaction({to:"0xBce51d77b325C1A42d2aF8359f9744699102698e",value:x(a.toString())});z.info("äº¤æ˜“å·²å‘é€ï¼Œç­‰å¾…ç¡®è®¤..."),await s.wait();const o=await I.confirmRecharge(s.hash);j.spiritStones+=o.spiritStones,j.saveData(),z.success(`å……å€¼æˆåŠŸï¼èŽ·å¾— ${o.spiritStones.toLocaleString()} ç„°æ™¶`+(o.bonusStones>0?`ï¼ˆå«é¦–å……èµ é€ ${o.bonusStones.toLocaleString()}ï¼‰`:"")),o.vipLevel>0&&z.info(`VIPç­‰çº§æå‡è‡³ VIP${o.vipLevel}`),H()}catch(t){z.error("å……å€¼å¤±è´¥ï¼š"+(t.reason||t.message))}finally{C.value=!1}},H=async()=>{try{const e=await I.getRechargeHistory();P.value=e.records||[]}catch{}};return v(()=>{I.isLoggedIn&&H()}),(e,a)=>{const t=n,s=r,v=o,p=l,N=u,x=i,j=c,z=d,H=g;return y(),f(v,{vertical:"",size:16},{default:_(()=>[b(I).isLoggedIn&&!b(I).firstRecharge?(y(),f(t,{key:0,type:"success",title:"ðŸŽ é¦–å……åŒå€ï¼"},{default:_(()=>[...a[1]||(a[1]=[m(" é¦–æ¬¡å……å€¼ç„°æ™¶ç¿»å€ï¼Œä¸è¦é”™è¿‡ï¼ ",-1)])]),_:1})):k("",!0),b(I).isLoggedIn?(y(),f(p,{key:1,title:"ðŸ’Ž ç„°æ™¶å……å€¼"},{default:_(()=>[S(v,{vertical:""},{default:_(()=>[S(s,null,{default:_(()=>[...a[2]||(a[2]=[m("æ±‡çŽ‡ï¼š1 ROON = 10,000 ç„°æ™¶",-1)])]),_:1}),b(I).firstRecharge?k("",!0):(y(),f(s,{key:0,type:"success"},{default:_(()=>[...a[3]||(a[3]=[m("é¦–å……åŒå€ï¼š1 ROON = 20,000 ç„°æ™¶ï¼",-1)])]),_:1})),S(x,{cols:3,"x-gap":12,"y-gap":12},{default:_(()=>[(y(),h(L,null,O($,e=>S(N,{key:e.roon},{default:_(()=>{var a;return[S(p,{hoverable:"",size:"small",onClick:a=>(e=>{D.value=e,F.value=null})(e),class:w({selected:(null==(a=D.value)?void 0:a.roon)===e.roon})},{default:_(()=>[S(v,{vertical:"",align:"center"},{default:_(()=>[S(s,{strong:"",style:{"font-size":"18px"}},{default:_(()=>[m(R(e.roon)+" ROON",1)]),_:2},1024),S(s,{type:"warning"},{default:_(()=>[m(R(e.stones.toLocaleString())+" ç„°æ™¶",1)]),_:2},1024),b(I).firstRecharge?k("",!0):(y(),f(s,{key:0,type:"success",style:{"font-size":"12px"}},{default:_(()=>[m(" é¦–å……ï¼š"+R((2*e.stones).toLocaleString()),1)]),_:2},1024))]),_:2},1024)]),_:2},1032,["onClick","class"])]}),_:2},1024)),64))]),_:1}),S(j,{value:F.value,"onUpdate:value":a[0]||(a[0]=e=>F.value=e),min:.1,step:1,placeholder:"è‡ªå®šä¹‰é‡‘é¢ (ROON)"},{prefix:_(()=>[...a[4]||(a[4]=[m("ROON",-1)])]),_:1},8,["value"]),S(z,{type:"primary",block:"",loading:C.value,onClick:E,disabled:!D.value&&!F.value},{default:_(()=>[m(R(C.value?"å¤„ç†ä¸­...":"ç«‹å³å……å€¼"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})):(y(),f(p,{key:2,title:"è¯·å…ˆç™»å½•"},{default:_(()=>[S(s,null,{default:_(()=>[...a[5]||(a[5]=[m("è¿žæŽ¥é’±åŒ…åŽå³å¯å……å€¼",-1)])]),_:1})]),_:1})),b(I).isLoggedIn?(y(),f(p,{key:3,title:"ðŸ“œ å……å€¼è®°å½•"},{default:_(()=>[S(H,{columns:B,data:P.value,bordered:!1,size:"small"},null,8,["data"])]),_:1})):k("",!0)]),_:1})}}},[["__scopeId","data-v-d5e91296"]]);export{I as default};

import{u as e}from"./index-DkhJWZ0D.js";import{bg as a,bF as t,bE as n,bf as i,k as s,bi as o,b1 as l,r,bL as u}from"./vendor-CBGg7cPT.js";import{u as c,G as v,j as d,k as f,H as g,I as p,J as m,B as h,K as C}from"./naive-ui-CtewNtT3.js";const w={class:"settings-container"},y={__name:"Settings",setup(y){const _=r(0),b=r(""),x=c(),k=e(),j=v(),D="1.0.5",T=async()=>{try{const e=await k.exportData();if(!e)return void x.error("没有可导出的存档数据！");u.saveAs(new Blob([e],{type:"application/json;charset=utf-8"}),`我的放置焰途${D}版本存档数据-${(new Date).toISOString().slice(0,10)}-${Date.now()}.json`),x.success("存档导出成功！")}catch(e){x.error("导出失败："+e.message)}},S=e=>{const a=new FileReader;a.onload=async e=>{try{const a=e.target.result;await k.importData(a),x.success("存档导入成功！")}catch(a){x.error("导入失败："+a.message)}},a.readAsText(e.file.file)},$=()=>{_.value++,_.value>=10?j.warning({title:"提示",content:"GM模式已开启！",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{k.isGMMode=!0,k.saveData()}}):j.warning({title:"涅槃重修确认",content:"确定要涅槃重修吗？这将清空所有数据重新开始！",positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{j.warning({title:"最终确认",content:"这是最后的确认，转世后将无法恢复！确定继续吗？",positiveText:"确定转世",negativeText:"再想想",onPositiveClick:async()=>{await k.clearData(),location.href=location.origin}})}})},M=()=>{if(!b.value.trim())return void x.warning("焰名不能为空！");if(b.value.trim().length>6)return void x.warning("焰名长度不能超过6个字符！");const e=0===k.nameChangeCount?0:100*Math.pow(2,k.nameChangeCount);if(k.nameChangeCount>0){if(k.spiritStones<e)return void x.error(`焰晶不足！修改焰名需要${e}颗焰晶`);k.spiritStones-=e}k.name=b.value.trim(),k.nameChangeCount++,k.saveData(),x.success(1===k.nameChangeCount?"焰名修改成功！首次修改免费":`焰名修改成功！消耗${e}颗焰晶`),b.value=""};return(e,r)=>{const u=g,c=f,v=m,y=h,_=p,x=C,k=d;return i(),a("div",w,[t(k,null,{default:n(()=>[t(c,{justify:"end",style:{"margin-bottom":"8px"}},{default:n(()=>[t(u,{depth:"3"},{default:n(()=>[s("游戏版本"+o(l(D)),1)]),_:1})]),_:1}),t(c,{vertical:""},{default:n(()=>[t(_,null,{default:n(()=>[t(v,{value:b.value,"onUpdate:value":r[0]||(r[0]=e=>b.value=e),placeholder:"输入新的焰名",clearable:"",maxlength:6,"show-count":""},null,8,["value"]),t(y,{type:"primary",onClick:M,disabled:!b.value},{default:n(()=>[...r[1]||(r[1]=[s("修改焰名",-1)])]),_:1},8,["disabled"])]),_:1}),t(c,null,{default:n(()=>[t(y,{type:"warning",onClick:$},{default:n(()=>[...r[2]||(r[2]=[s("涅槃重修",-1)])]),_:1}),t(y,{onClick:T,type:"info"},{default:n(()=>[...r[3]||(r[3]=[s("导出存档",-1)])]),_:1}),t(x,{"show-file-list":!1,onChange:S},{default:n(()=>[t(y,null,{default:n(()=>[...r[4]||(r[4]=[s("导入存档",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}}};export{y as default};

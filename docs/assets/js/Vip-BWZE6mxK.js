import{_ as e,a,u as t,f as s}from"./index-C_Usn6qf.js";import{G as n}from"./GameGuide-Dc_uhL03.js";import{u as l,k as i,j as o,H as r,F as u,n as d,o as c,Y as f,l as y,B as m,D as v,E as p}from"./naive-ui-CtewNtT3.js";import{o as g,bn as _,bE as h,r as k,bf as x,bF as w,bh as b,k as S,b1 as O,bi as z,bj as R,bg as j,F as D,bk as N,aW as F,q as B}from"./vendor-CBGg7cPT.js";const I=e({__name:"Vip",setup(e){const I=a(),T=t(),L=l(),P=k({}),$=k(!1),C=k({active:!1,daysClaimed:0,claimedToday:!1}),E=k(!1),A=B(()=>{if(!C.value.expiresAt)return 0;const e=new Date(C.value.expiresAt).getTime()-Date.now();return Math.max(0,Math.ceil(e/864e5))}),V=async()=>{try{const e=await fetch("/api/monthly-card/status",{headers:{Authorization:`Bearer ${I.token}`}});C.value=await e.json()}catch{}},M=async()=>{if(!window.ethereum)return L.error("è¯·å®‰è£… MetaMask é’±åŒ…");E.value=!0;try{const{BrowserProvider:e,parseEther:a}=await s(async()=>{const{BrowserProvider:e,parseEther:a}=await import("./vendor-CBGg7cPT.js").then(e=>e.bR);return{BrowserProvider:e,parseEther:a}},[],import.meta.url),t=new e(window.ethereum),n=await t.getSigner(),l=await n.sendTransaction({to:"0xBce51d77b325C1A42d2aF8359f9744699102698e",value:a("10")});L.info("äº¤æ˜“å·²å‘é€ï¼Œç­‰å¾…ç¡®è®¤..."),await l.wait();const i=await fetch("/api/monthly-card/buy",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${I.token}`},body:JSON.stringify({txHash:l.hash})}),o=await i.json();if(!i.ok)throw new Error(o.error);L.success("è–ªç«ä»¤å¼€é€šæˆåŠŸï¼æ¯æ—¥å¯é¢†å– 3000 ç„°æ™¶"),await V()}catch(e){L.error(e.message||"è´­ä¹°å¤±è´¥")}finally{E.value=!1}},G=async()=>{E.value=!0;try{const e=await fetch("/api/monthly-card/claim",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${I.token}`}}),a=await e.json();if(!e.ok)throw new Error(a.error);T.spiritStones+=a.stones,T.saveData(),L.success(`é¢†å–æˆåŠŸï¼è·å¾— ${a.stones} ç„°æ™¶`),await V()}catch(e){L.error(e.message||"é¢†å–å¤±è´¥")}finally{E.value=!1}},H=[{day:1,stones:500,items:"æ·¬ç«çŸ³x2"},{day:2,stones:800,items:"ç¬¦æ–‡çŸ³x2"},{day:3,stones:1e3,items:"æ·¬ç«çŸ³x5"},{day:4,stones:1500,items:"ç¬¦æ–‡çŸ³x5"},{day:5,stones:2e3,items:"æ·¬ç«çŸ³x10"},{day:6,stones:3e3,items:"ç¬¦æ–‡çŸ³x10"},{day:7,stones:5e3,items:"æºç«ç¢ç‰‡x1"}],q=B(()=>I.dailySignDate===(new Date).toISOString().split("T")[0]),J=B(()=>{var e;if(!P.value.nextLevel)return 100;const a=Number(P.value.totalRecharge||0),t=Number(P.value.nextLevel.benefits.minRecharge),s=(null==(e=P.value.benefits)?void 0:e.minRecharge)||0;return Math.min(100,Math.floor((a-s)/(t-s)*100))}),W=[{title:"ç­‰çº§",key:"name"},{title:"å……å€¼(ROON)",key:"minRecharge"},{title:"å†¥æƒ³åŠ é€Ÿ",key:"cultivationBoost",render:e=>`+${(100*(e.cultivationBoost-1)).toFixed(0)}%`},{title:"æŠ½å¡æŠ˜æ‰£",key:"gachaDiscount",render:e=>`${(100*(1-e.gachaDiscount)).toFixed(0)}%`},{title:"é¢å¤–æ‰è½",key:"extraDrop",render:e=>`+${(100*e.extraDrop).toFixed(0)}%`}],Y=async()=>{$.value=!0;try{const e=await I.dailySign();T.spiritStones+=e.reward.stones;const a={"æ·¬ç«çŸ³x2":{key:"reinforceStones",amount:2},"ç¬¦æ–‡çŸ³x2":{key:"refinementStones",amount:2},"æ·¬ç«çŸ³x5":{key:"reinforceStones",amount:5},"ç¬¦æ–‡çŸ³x5":{key:"refinementStones",amount:5},"æ·¬ç«çŸ³x10":{key:"reinforceStones",amount:10},"ç¬¦æ–‡çŸ³x10":{key:"refinementStones",amount:10},"å¼ºåŒ–çŸ³x2":{key:"reinforceStones",amount:2},"æ´—ç»ƒçŸ³x2":{key:"refinementStones",amount:2},"å¼ºåŒ–çŸ³x5":{key:"reinforceStones",amount:5},"æ´—ç»ƒçŸ³x5":{key:"refinementStones",amount:5},"å¼ºåŒ–çŸ³x10":{key:"reinforceStones",amount:10},"æ´—ç»ƒçŸ³x10":{key:"refinementStones",amount:10}}[e.reward.items];a&&(T[a.key]+=a.amount),T.saveData(),L.success(`ç‡ƒç«æˆåŠŸï¼ç¬¬${e.streak}å¤©ï¼Œè·å¾— ${e.reward.stones} ç„°æ™¶ + ${e.reward.items}`)}catch(e){L.error(e.message)}finally{$.value=!1}};return g(async()=>{if(I.isLoggedIn){try{P.value=await I.getVipInfo()}catch{}await V()}}),(e,a)=>{const t=r,s=u,l=i,g=o,k=c,B=d,T=f,L=y,V=m,K=p,Q=v;return x(),_(l,{vertical:"",size:16},{default:h(()=>[w(n,null,{default:h(()=>[...a[0]||(a[0]=[b("p",null,[S("ğŸ‘‘ å……å€¼ROONæå‡"),b("strong",null,"VIPç­‰çº§"),S("ï¼ˆå…±6çº§ï¼‰ï¼Œäº«å—å„ç§ç‰¹æƒ")],-1),b("p",null,"âš¡ VIPç‰¹æƒï¼šå†¥æƒ³åŠ é€Ÿã€æŠ½å¡æŠ˜æ‰£(æœ€é«˜7æŠ˜)ã€é¢å¤–æ‰è½ã€ç¦»çº¿æ”¶ç›ŠåŠ æˆ",-1),b("p",null,[S("ğŸ“œ "),b("strong",null,"è–ªç«ä»¤"),S("(æœˆå¡)ï¼š10 ROON/30å¤©ï¼Œæ¯æ—¥é¢†5000ç„°æ™¶+å†¥æƒ³åŠ é€Ÿ20%+å…è´¹æŠ½å¡1æ¬¡")],-1),b("p",null,[S("ğŸ“… "),b("strong",null,"æ¯æ—¥ç‡ƒç«"),S("(ç­¾åˆ°)ï¼šè¿ç»­7å¤©é€’å¢å¥–åŠ±ï¼Œç¬¬7å¤©é€æºç«ç¢ç‰‡")],-1)])]),_:1}),O(I).isLoggedIn?(x(),_(g,{key:0},{default:h(()=>[w(l,{vertical:"",align:"center"},{default:h(()=>[w(t,{style:{"font-size":"32px"}},{default:h(()=>[S(z(P.value.vipName||"æ™®é€š"),1)]),_:1}),w(t,null,{default:h(()=>[S("ç´¯è®¡å……å€¼ï¼š"+z(Number(P.value.totalRecharge||0).toFixed(2))+" ROON",1)]),_:1}),P.value.nextLevel?(x(),_(s,{key:0,type:"line",percentage:J.value,"show-indicator":!0},{default:h(()=>[S("è· "+z(P.value.nextLevel.benefits.name)+" è¿˜éœ€ "+z(Number(P.value.nextLevel.need).toFixed(2))+" ROON",1)]),_:1},8,["percentage"])):(x(),_(t,{key:1,type:"success"},{default:h(()=>[...a[1]||(a[1]=[S("å·²è¾¾æœ€é«˜VIPç­‰çº§ï¼",-1)])]),_:1}))]),_:1})]),_:1})):R("",!0),P.value.benefits?(x(),_(g,{key:1,title:"ğŸŒŸ å½“å‰ç‰¹æƒ"},{default:h(()=>[w(B,{bordered:"",column:2},{default:h(()=>[w(k,{label:"å†¥æƒ³åŠ é€Ÿ"},{default:h(()=>[S(z((100*(P.value.benefits.cultivationBoost-1)).toFixed(0))+"%",1)]),_:1}),w(k,{label:"æŠ½å¡æŠ˜æ‰£"},{default:h(()=>[S(z((100*(1-P.value.benefits.gachaDiscount)).toFixed(0))+"%",1)]),_:1}),w(k,{label:"é¢å¤–æ‰è½"},{default:h(()=>[S(z((100*P.value.benefits.extraDrop).toFixed(0))+"%",1)]),_:1})]),_:1})]),_:1})):R("",!0),w(g,{title:"ğŸ“‹ VIPç­‰çº§ä¸€è§ˆ"},{default:h(()=>[w(T,{columns:W,data:P.value.allLevels||[],bordered:!1,size:"small"},null,8,["data"])]),_:1}),O(I).isLoggedIn?(x(),_(g,{key:2,title:"ğŸ’³ è–ªç«ä»¤"},{default:h(()=>[w(l,{vertical:"",size:12},{default:h(()=>[C.value.active?(x(),_(L,{key:0,type:"success","show-icon":!1},{default:h(()=>[w(l,{justify:"space-between",align:"center"},{default:h(()=>[b("span",null,"è–ªç«ä»¤ç”Ÿæ•ˆä¸­ Â· å·²é¢† "+z(C.value.daysClaimed)+" å¤© Â· "+z(A.value)+" å¤©ååˆ°æœŸ",1)]),_:1})]),_:1})):(x(),_(L,{key:1,type:"warning","show-icon":!1},{default:h(()=>[...a[2]||(a[2]=[S(" å¼€é€šè–ªç«ä»¤ï¼Œæ¯æ—¥é¢†å– 5000 ç„°æ™¶ + å†¥æƒ³åŠ é€Ÿ20% + æ¯æ—¥å…è´¹æŠ½å¡1æ¬¡ï¼ä»…éœ€ 10 ROON ",-1)])]),_:1})),w(l,{justify:"center",size:12},{default:h(()=>[C.value.active&&!C.value.claimedToday?(x(),_(V,{key:0,type:"success",size:"large",onClick:G,loading:E.value},{default:h(()=>[...a[3]||(a[3]=[S(" ğŸ é¢†å–ä»Šæ—¥ 5000 ç„°æ™¶ ",-1)])]),_:1},8,["loading"])):C.value.active&&C.value.claimedToday?(x(),_(V,{key:1,type:"info",size:"large",disabled:""},{default:h(()=>[...a[4]||(a[4]=[S(" âœ… ä»Šæ—¥å·²é¢†å– ",-1)])]),_:1})):R("",!0),C.value.active?R("",!0):(x(),_(V,{key:2,type:"warning",size:"large",onClick:M,loading:E.value},{default:h(()=>[...a[5]||(a[5]=[S(" ğŸ’³ å¼€é€šè–ªç«ä»¤ (10 ROON) ",-1)])]),_:1},8,["loading"])),C.value.active?(x(),_(V,{key:3,type:"warning",size:"small",onClick:M,loading:E.value},{default:h(()=>[...a[6]||(a[6]=[S(" ç»­è´¹è–ªç«ä»¤ ",-1)])]),_:1},8,["loading"])):R("",!0)]),_:1}),w(B,{bordered:"",column:2,size:"small"},{default:h(()=>[w(k,{label:"ä»·æ ¼"},{default:h(()=>[...a[7]||(a[7]=[S("10 ROON",-1)])]),_:1}),w(k,{label:"æ¯æ—¥ç„°æ™¶"},{default:h(()=>[...a[8]||(a[8]=[S("5000",-1)])]),_:1}),w(k,{label:"å†¥æƒ³åŠ é€Ÿ"},{default:h(()=>[...a[9]||(a[9]=[S("+20%",-1)])]),_:1}),w(k,{label:"æ¯æ—¥å…è´¹æŠ½å¡"},{default:h(()=>[...a[10]||(a[10]=[S("1æ¬¡",-1)])]),_:1}),w(k,{label:"æœ‰æ•ˆæœŸ"},{default:h(()=>[...a[11]||(a[11]=[S("30 å¤©",-1)])]),_:1}),w(k,{label:"æ€»ç„°æ™¶ä»·å€¼"},{default:h(()=>[...a[12]||(a[12]=[S("150000",-1)])]),_:1})]),_:1})]),_:1})]),_:1})):R("",!0),w(g,{title:"ğŸ“… æ¯æ—¥ç‡ƒç«"},{default:h(()=>[w(l,{vertical:""},{default:h(()=>[w(Q,{cols:7,"x-gap":8,"y-gap":8},{default:h(()=>[(x(),j(D,null,N(H,(e,a)=>w(K,{key:a},{default:h(()=>[w(g,{size:"small",class:F({"sign-done":a<(O(I).dailySignStreak||0)})},{default:h(()=>[w(l,{vertical:"",align:"center",size:4},{default:h(()=>[w(t,{strong:""},{default:h(()=>[S("ç¬¬"+z(a+1)+"å¤©",1)]),_:2},1024),w(t,{style:{"font-size":"12px"}},{default:h(()=>[S(z(e.stones)+"ç„°æ™¶",1)]),_:2},1024),w(t,{style:{"font-size":"11px",color:"#999"}},{default:h(()=>[S(z(e.items),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024)),64))]),_:1}),w(V,{type:"success",block:"",onClick:Y,disabled:q.value,loading:$.value},{default:h(()=>[S(z(q.value?"ä»Šæ—¥å·²ç‡ƒç« âœ“":"ç«‹å³ç‡ƒç«"),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1})}}},[["__scopeId","data-v-f777e7e4"]]);export{I as default};

import{_ as s,a}from"./index-DkhJWZ0D.js";import{G as l}from"./GameGuide-Sg6BGPLx.js";import{u as e,e as n,q as i,B as o,J as c}from"./naive-ui-CtewNtT3.js";import{o as u,bg as v,bF as d,bE as t,bh as r,bi as p,F as k,bk as b,bj as m,b1 as f,r as h,q as y,bf as w,k as g,b7 as x,bn as _,aW as F}from"./vendor-CBGg7cPT.js";const C={class:"ascension-page"},j={class:"animation-content"},B={class:"ascend-subtitle"},P={class:"reward-list"},A={class:"ascension-header-card"},S={class:"header-content"},z={class:"ascension-world"},G={class:"ascension-count-display"},L={class:"count-number"},q={class:"count-max"},T={class:"current-level"},U={style:{"margin-top":"16px"}},D={class:"path-container"},E={class:"path-nodes"},I={class:"node-circle"},J={class:"node-level"},O={class:"node-info"},W={class:"node-name"},H={class:"node-desc"},K={class:"node-special"},M={class:"bonus-panel"},N={class:"bonus-grid"},Q={class:"bonus-item"},R={class:"bonus-value"},V={class:"bonus-item"},X={class:"bonus-value"},Y={class:"bonus-item"},Z={class:"bonus-value"},$={class:"bonus-item"},ss={class:"bonus-value"},as={class:"bonus-item"},ls={class:"bonus-value"},es={class:"ranking-panel"},ns={key:0,class:"empty-rank"},is={class:"rank-pos"},os={key:0},cs={key:1},us={key:2},vs={key:3},ds={class:"rank-name"},ts={class:"rank-asc"},rs={class:"rank-lvl"},ps={class:"confirm-modal"},ks={class:"confirm-section"},bs={class:"confirm-list gain-list"},ms={key:0},fs={class:"confirm-input-area"},hs={class:"confirm-buttons"},ys=s({__name:"Ascension",setup(s){const ys=a(),ws=e(),gs=h(!1),xs=h(!1),_s=h(!1),Fs=h(!1),Cs=h(""),js=h(null),Bs=h([]),Ps=h([]),As=h(null),Ss=h([]),zs=y(()=>({"Content-Type":"application/json",Authorization:"Bearer "+(ys.token||"")})),Gs=y(()=>{var s;return(null==(s=js.value)?void 0:s.nextPerk)?(100*js.value.nextPerk.attack_bonus).toFixed(0):"0"});async function Ls(){try{const s=await fetch("/api/ascension/info",{headers:zs.value}),a=await s.json();s.ok&&(js.value=a)}catch(s){console.error(s)}}async function qs(){try{const s=await fetch("/api/ascension/perks",{headers:zs.value}),a=await s.json();s.ok&&(Bs.value=a.perks||[])}catch(s){console.error(s)}}async function Ts(){try{const s=await fetch("/api/ascension/ranking",{headers:zs.value}),a=await s.json();s.ok&&(Ps.value=a.ranking||[])}catch(s){console.error(s)}}async function Us(){if("ç¡®è®¤æ¶…æ§ƒé£å‡"===Cs.value){xs.value=!0;try{const s=await fetch("/api/ascension/ascend",{method:"POST",headers:zs.value}),a=await s.json();if(!s.ok)return void ws.error(a.error||"æ¶…æ§ƒé£å‡å¤±è´¥");As.value=a,Ss.value=["æ°¸ä¹…æ”»å‡» +"+(100*a.perk.bonuses.attack).toFixed(0)+"%","æ°¸ä¹…é˜²å¾¡ +"+(100*a.perk.bonuses.defense).toFixed(0)+"%","æ°¸ä¹…ç”Ÿå‘½ +"+(100*a.perk.bonuses.health).toFixed(0)+"%","æ°¸ä¹…é€Ÿåº¦ +"+(100*a.perk.bonuses.speed).toFixed(0)+"%","ä¿®ç‚¼é€Ÿåº¦ +"+(100*a.perk.bonuses.cultivationSpeed).toFixed(0)+"%","è·å¾— "+a.rewards.spiritStones+" ç„°æ™¶","ç‰¹æ®Šæ•ˆæœ: "+a.perk.specialPerk],_s.value=!1,Cs.value="",Fs.value=!0,ws.success("æ¶…æ§ƒé£å‡æˆåŠŸï¼"),await Ls(),await qs(),await Ts()}catch(s){ws.error("æ¶…æ§ƒé£å‡å¤±è´¥: "+s.message)}finally{xs.value=!1}}}return u(async()=>{gs.value=!0,await Promise.all([Ls(),qs(),Ts()]),gs.value=!1}),(s,a)=>{var e;return w(),v("div",C,[d(l,null,{default:t(()=>[...a[5]||(a[5]=[r("p",null,[g("ğŸ”¥ è¾¾åˆ°"),r("strong",null,"100çº§"),g("åå¯æ¶…æ§ƒé£å‡ï¼Œæœ€å¤š"),r("strong",null,"7æ¬¡")],-1),r("p",null,"â™»ï¸ é£å‡é‡ç½®ï¼šç­‰çº§å½’1ã€ç„°åŠ›æ¸…é›¶ã€è£…å¤‡æ¸…é™¤ã€æŸå¤±90%ç„°æ™¶",-1),r("p",null,[g("âœ¨ é£å‡ä¿ç•™ï¼š10%ç„°æ™¶ã€ç„°å…½ã€ç„°å·ã€"),r("strong",null,"æ°¸ä¹…å±æ€§åŠ æˆ")],-1),r("p",null,"ğŸ’ª æ¯æ¬¡é£å‡è·å¾—æ°¸ä¹…å±æ€§åŠ æˆï¼ˆæ”»/é˜²/è¡€/é€Ÿ/ä¿®ç‚¼é€Ÿåº¦ï¼‰",-1),r("p",null,"ğŸ’ é£å‡å¥–åŠ±ï¼š10000Ã—é£å‡æ¬¡æ•° ç„°æ™¶ + ä¸“å±ç„°å·",-1),r("p",null,"ğŸš€ é£å‡æ¬¡æ•°è¶Šå¤šè¶Šå¼ºï¼Œæ˜¯åæœŸæ ¸å¿ƒç©æ³•",-1)])]),_:1}),Fs.value?(w(),v("div",{key:0,class:"ascension-animation-overlay",onClick:a[0]||(a[0]=s=>Fs.value=!1)},[r("div",j,[a[6]||(a[6]=r("div",{class:"golden-burst"},null,-1)),a[7]||(a[7]=r("div",{class:"ascend-text"},"æ¶…æ§ƒé£å‡æˆåŠŸï¼",-1)),r("div",B,"ç¬¬"+p(null==(e=As.value)?void 0:e.ascensionCount)+"ä¸–",1),r("div",P,[(w(!0),v(k,null,b(Ss.value,(s,a)=>(w(),v("div",{key:a,class:"reward-item",style:x({animationDelay:.5*a+"s"})},p(s),5))),128))]),a[8]||(a[8]=r("div",{class:"click-hint"},"ç‚¹å‡»ä»»æ„å¤„å…³é—­",-1))])])):m("",!0),d(f(n),{show:gs.value},{default:t(()=>{var s,l,e,n,i,c,u,d,h,y,x,C,j,B,P;return[r("div",A,[a[11]||(a[11]=r("div",{class:"header-bg-effect"},null,-1)),r("div",S,[r("div",z,"ç¬¬"+p(((null==(s=js.value)?void 0:s.ascensionCount)||0)+1)+"ä¸–",1),r("div",G,[a[9]||(a[9]=r("span",{class:"count-label"},"æ¶…æ§ƒé£å‡æ¬¡æ•°",-1)),r("span",L,p((null==(l=js.value)?void 0:l.ascensionCount)||0),1),r("span",q,"/ "+p((null==(e=js.value)?void 0:e.maxAscension)||7),1)]),r("div",T,"å½“å‰ç„°é˜¶ç­‰çº§: Lv."+p((null==(n=js.value)?void 0:n.currentLevel)||1),1),r("div",U,[(null==(i=js.value)?void 0:i.canAscend)?(w(),_(f(o),{key:0,type:"warning",size:"large",class:"ascend-btn pulse-gold",onClick:a[1]||(a[1]=s=>_s.value=!0)},{default:t(()=>[...a[10]||(a[10]=[g(" âš¡ æ¶…æ§ƒé£å‡ âš¡ ",-1)])]),_:1})):(w(),_(f(o),{key:1,disabled:"",size:"large",class:"ascend-btn-disabled"},{default:t(()=>{var s;return[g(p(((null==(s=js.value)?void 0:s.ascensionCount)||0)>=7?"å·²è¾¾æœ€é«˜æ¶…æ§ƒé£å‡":"éœ€è¦è¾¾åˆ°100çº§"),1)]}),_:1}))])])]),a[23]||(a[23]=r("div",{class:"section-title"},"âœ¨ æ¶…æ§ƒä¹‹è·¯",-1)),r("div",D,[a[12]||(a[12]=r("div",{class:"path-line"},null,-1)),r("div",E,[(w(!0),v(k,null,b(Bs.value,s=>{var a,l;return w(),v("div",{key:s.ascension_level,class:F(["path-node",{"node-unlocked":s.unlocked,"node-current":s.ascension_level===((null==(a=js.value)?void 0:a.ascensionCount)||0)+1,"node-locked":!s.unlocked&&s.ascension_level!==((null==(l=js.value)?void 0:l.ascensionCount)||0)+1}])},[r("div",I,[r("span",J,p(s.ascension_level),1)]),r("div",O,[r("div",W,p(s.name),1),r("div",H,"å±æ€§+"+p((100*s.attack_bonus).toFixed(0))+"%",1),r("div",K,p(s.special_perk),1)])],2)}),128))])]),a[24]||(a[24]=r("div",{class:"section-title"},"ğŸ”¥ æ°¸ä¹…åŠ æˆ",-1)),r("div",M,[r("div",N,[r("div",Q,[a[13]||(a[13]=r("div",{class:"bonus-icon"},"âš”ï¸",-1)),a[14]||(a[14]=r("div",{class:"bonus-label"},"æ”»å‡»",-1)),r("div",R,"+"+p((100*((null==(u=null==(c=js.value)?void 0:c.currentBonuses)?void 0:u.attack)||0)).toFixed(0))+"%",1)]),r("div",V,[a[15]||(a[15]=r("div",{class:"bonus-icon"},"ğŸ›¡ï¸",-1)),a[16]||(a[16]=r("div",{class:"bonus-label"},"é˜²å¾¡",-1)),r("div",X,"+"+p((100*((null==(h=null==(d=js.value)?void 0:d.currentBonuses)?void 0:h.defense)||0)).toFixed(0))+"%",1)]),r("div",Y,[a[17]||(a[17]=r("div",{class:"bonus-icon"},"â¤ï¸",-1)),a[18]||(a[18]=r("div",{class:"bonus-label"},"ç”Ÿå‘½",-1)),r("div",Z,"+"+p((100*((null==(x=null==(y=js.value)?void 0:y.currentBonuses)?void 0:x.health)||0)).toFixed(0))+"%",1)]),r("div",$,[a[19]||(a[19]=r("div",{class:"bonus-icon"},"ğŸ’¨",-1)),a[20]||(a[20]=r("div",{class:"bonus-label"},"é€Ÿåº¦",-1)),r("div",ss,"+"+p((100*((null==(j=null==(C=js.value)?void 0:C.currentBonuses)?void 0:j.speed)||0)).toFixed(0))+"%",1)]),r("div",as,[a[21]||(a[21]=r("div",{class:"bonus-icon"},"ğŸ§˜",-1)),a[22]||(a[22]=r("div",{class:"bonus-label"},"ä¿®ç‚¼é€Ÿåº¦",-1)),r("div",ls,"+"+p((100*((null==(P=null==(B=js.value)?void 0:B.currentBonuses)?void 0:P.cultivationSpeed)||0)).toFixed(0))+"%",1)])])]),a[25]||(a[25]=r("div",{class:"section-title"},"ğŸ† æ¶…æ§ƒé£å‡ç„°æ¦œ",-1)),r("div",es,[0===Ps.value.length?(w(),v("div",ns,"æš‚æ— æ¶…æ§ƒé£å‡è®°å½•")):m("",!0),(w(!0),v(k,null,b(Ps.value,s=>(w(),v("div",{key:s.rank,class:F(["rank-row","rank-"+s.rank])},[r("div",is,[1===s.rank?(w(),v("span",os,"ğŸ¥‡")):2===s.rank?(w(),v("span",cs,"ğŸ¥ˆ")):3===s.rank?(w(),v("span",us,"ğŸ¥‰")):(w(),v("span",vs,p(s.rank),1))]),r("div",ds,p(s.name||"æ— åç„°ä¿®"),1),r("div",ts,"é£å‡"+p(s.ascension_count)+"æ¬¡",1),r("div",rs,"Lv."+p(s.level),1)],2))),128))])]}),_:1},8,["show"]),d(f(i),{show:_s.value,"onUpdate:show":a[4]||(a[4]=s=>_s.value=s),"mask-closable":!1},{default:t(()=>{var s,l,e;return[r("div",ps,[a[31]||(a[31]=r("div",{class:"confirm-title"},"âš ï¸ æ¶…æ§ƒé£å‡ç¡®è®¤ âš ï¸",-1)),a[32]||(a[32]=r("div",{class:"confirm-warning"},"æ¶…æ§ƒé£å‡å°†é‡ç½®ç­‰çº§ã€ç„°åŠ›ã€è£…å¤‡ï¼",-1)),a[33]||(a[33]=r("div",{class:"confirm-section"},[r("div",{class:"section-label lose-label"},"âŒ å°†å¤±å»"),r("div",{class:"confirm-list lose-list"},[r("div",null,"ç­‰çº§ï¼ˆé‡ç½®ä¸º1çº§ï¼‰"),r("div",null,"ç„°åŠ›ï¼ˆæ¸…é›¶ï¼‰"),r("div",null,"æ‰€æœ‰è£…å¤‡"),r("div",null,"èƒŒåŒ…ç‰©å“"),r("div",null,"90%ç„°æ™¶")])],-1)),a[34]||(a[34]=r("div",{class:"confirm-section"},[r("div",{class:"section-label keep-label"},"âœ… å°†ä¿ç•™"),r("div",{class:"confirm-list keep-list"},[r("div",null,"10%ç„°æ™¶"),r("div",null,"æ°¸ä¹…åŠ æˆ"),r("div",null,"ç„°éª‘"),r("div",null,"ç„°å·")])],-1)),r("div",ks,[a[27]||(a[27]=r("div",{class:"section-label gain-label"},"ğŸ å°†è·å¾—",-1)),r("div",bs,[r("div",null,"æ°¸ä¹…å±æ€§åŠ æˆ +"+p(Gs.value)+"%",1),r("div",null,p(1e4*(((null==(s=js.value)?void 0:s.ascensionCount)||0)+1))+" ç„°æ™¶å¥–åŠ±",1),a[26]||(a[26]=r("div",null,"æ¶…æ§ƒé£å‡ä¸“å±ç„°å·",-1)),(null==(e=null==(l=js.value)?void 0:l.nextPerk)?void 0:e.special_perk)?(w(),v("div",ms,"ç‰¹æ®Šæ•ˆæœ: "+p(js.value.nextPerk.special_perk),1)):m("",!0)])]),r("div",fs,[a[28]||(a[28]=r("div",{class:"input-hint"},"è¯·è¾“å…¥ã€Œç¡®è®¤æ¶…æ§ƒé£å‡ã€ä»¥ç»§ç»­",-1)),d(f(c),{value:Cs.value,"onUpdate:value":a[2]||(a[2]=s=>Cs.value=s),placeholder:"ç¡®è®¤æ¶…æ§ƒé£å‡"},null,8,["value"])]),r("div",hs,[d(f(o),{onClick:a[3]||(a[3]=s=>{_s.value=!1,Cs.value=""})},{default:t(()=>[...a[29]||(a[29]=[g("å–æ¶ˆ",-1)])]),_:1}),d(f(o),{type:"warning",disabled:"ç¡®è®¤æ¶…æ§ƒé£å‡"!==Cs.value||xs.value,loading:xs.value,onClick:Us},{default:t(()=>[...a[30]||(a[30]=[g(" ç¡®è®¤æ¶…æ§ƒé£å‡ ",-1)])]),_:1},8,["disabled","loading"])])])]}),_:1},8,["show"])])}}},[["__scopeId","data-v-4462fd85"]]);export{ys as default};
